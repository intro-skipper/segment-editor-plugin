import{a as g,j as b}from"./tanstack-vendor-DsGIZQUk.js";import{c as X,a as M}from"./index-Bjww99gb.js";import{j as Z}from"./media-vendor-CUSAIUeh.js";import{g as q,b as G}from"./feature-error-boundary-wVBPtxGl.js";const y=new Map,J=100;function O(v,e=32,t=32){const h=`${v}-${e}-${t}`,c=y.get(h);if(c)return c;try{const k=Z(v,e,t),a=document.createElement("canvas");a.width=e,a.height=t;const r=a.getContext("2d");if(!r)return null;const p=r.createImageData(e,t);p.data.set(k),r.putImageData(p,0,0);const n=a.toDataURL();if(y.size>=J){const s=y.keys().next().value;s&&y.delete(s)}return y.set(h,n),n}catch{return null}}function ee(v){const e=X.c(38),{item:t,maxWidth:h,maxHeight:c,alt:k,className:a,aspectRatio:r,showFallback:p}=v,n=h===void 0?300:h,s=r===void 0?"aspect-[2/3]":r,z=p===void 0?!0:p,[E,C]=g.useState(!1),[F,W]=g.useState(!1),$=g.useRef(null);let I;e[0]!==t||e[1]!==c||e[2]!==n?(I=q(t,n,c),e[0]=t,e[1]=c,e[2]=n,e[3]=I):I=e[3];const o=I;let x;if(e[4]!==t){e:{const l=G(t);if(!l){x=null;break e}x=O(l)}e[4]=t,e[5]=x}else x=e[5];const j=x;let _;e[6]===Symbol.for("react.memo_cache_sentinel")?(_=()=>{C(!1),W(!1)},e[6]=_):_=e[6];let N;e[7]!==t.Id?(N=[t.Id],e[7]=t.Id,e[8]=N):N=e[8],g.useEffect(_,N);let R;e[9]===Symbol.for("react.memo_cache_sentinel")?(R=()=>{$.current?.complete&&$.current.naturalWidth>0&&C(!0)},e[9]=R):R=e[9];let S;e[10]!==o?(S=[o],e[10]=o,e[11]=S):S=e[11],g.useEffect(R,S);let D;e[12]===Symbol.for("react.memo_cache_sentinel")?(D=()=>{C(!0)},e[12]=D):D=e[12];const K=D;let U;e[13]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{W(!0)},e[13]=U):U=e[13];const T=U,A=k||t.Name||"Media item";if(!o||F){if(!z)return null;let l;e[14]!==s||e[15]!==a?(l=M("bg-muted flex items-center justify-center rounded-lg overflow-hidden",s,a),e[14]=s,e[15]=a,e[16]=l):l=e[16];const H=t.Name||"No image";let d;e[17]!==H?(d=b.jsx("span",{className:"text-muted-foreground text-xs text-center px-2 line-clamp-2",children:H}),e[17]=H,e[18]=d):d=e[18];let L;return e[19]!==l||e[20]!==d?(L=b.jsx("div",{className:l,children:d}),e[19]=l,e[20]=d,e[21]=L):L=e[21],L}let i;e[22]!==s||e[23]!==a?(i=M("relative overflow-hidden rounded-lg bg-muted",s,a),e[22]=s,e[23]=a,e[24]=i):i=e[24];let m;e[25]!==j||e[26]!==E?(m=j&&!E&&b.jsx("img",{src:j,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover"}),e[25]=j,e[26]=E,e[27]=m):m=e[27];const B=E?"opacity-100":"opacity-0";let f;e[28]!==B?(f=M("absolute inset-0 w-full h-full object-cover transition-opacity duration-300",B),e[28]=B,e[29]=f):f=e[29];let u;e[30]!==A||e[31]!==o||e[32]!==f?(u=b.jsx("img",{ref:$,src:o,alt:A,loading:"lazy",decoding:"async",onLoad:K,onError:T,className:f}),e[30]=A,e[31]=o,e[32]=f,e[33]=u):u=e[33];let w;return e[34]!==i||e[35]!==m||e[36]!==u?(w=b.jsxs("div",{className:i,children:[m,u]}),e[34]=i,e[35]=m,e[36]=u,e[37]=w):w=e[37],w}export{ee as I};
