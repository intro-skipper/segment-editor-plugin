import{a as W,j as x}from"./tanstack-vendor-DcxxohBG.js";import{c as X,a as $}from"./index-RpOviJkQ.js";import{j as Z}from"./media-vendor-CUSAIUeh.js";import{g as q,u as G,e as J}from"./feature-error-boundary-BEcF-gHJ.js";const b=new Map,O=100;function P(y,e=32,t=32){const f=`${y}-${e}-${t}`,o=b.get(f);if(o)return o;try{const S=Z(y,e,t),s=document.createElement("canvas");s.width=e,s.height=t;const r=s.getContext("2d");if(!r)return null;const h=r.createImageData(e,t);h.data.set(S),r.putImageData(h,0,0);const c=s.toDataURL();if(b.size>=O){const l=b.keys().next().value;l&&b.delete(l)}return b.set(f,c),c}catch{return null}}function ae(y){const e=X.c(35),{item:t,maxWidth:f,maxHeight:o,alt:S,className:s,aspectRatio:r,showFallback:h}=y,c=f===void 0?300:f,l=r===void 0?"aspect-[2/3]":r,H=h===void 0?!0:h,[v,A]=W.useState(!1),[K,M]=W.useState(!1),D=W.useRef(null);let I;e[0]!==t||e[1]!==o||e[2]!==c?(I=q(t,c,o)??null,e[0]=t,e[1]=o,e[2]=c,e[3]=I):I=e[3];const g=G(I);let p;if(e[4]!==t){e:{const a=J(t);if(!a){p=null;break e}p=P(a)}e[4]=t,e[5]=p}else p=e[5];const j=p,k=g||t.Id;let E;e[6]===Symbol.for("react.memo_cache_sentinel")?(E=()=>{A(!0)},e[6]=E):E=e[6];const z=E;let _;e[7]===Symbol.for("react.memo_cache_sentinel")?(_=()=>{M(!0)},e[7]=_):_=e[7];const F=_;let N;e[8]===Symbol.for("react.memo_cache_sentinel")?(N=()=>{D.current?.complete&&D.current.naturalWidth>0&&A(!0)},e[8]=N):N=e[8];const T=N,C=S||t.Name||"Media item";if(!g||K){if(!H)return null;let a;e[9]!==l||e[10]!==s?(a=$("bg-muted flex items-center justify-center rounded-lg overflow-hidden",l,s),e[9]=l,e[10]=s,e[11]=a):a=e[11];const B=t.Name||"No image";let d;e[12]!==B?(d=x.jsx("span",{className:"text-muted-foreground text-xs text-center px-2 line-clamp-2",children:B}),e[12]=B,e[13]=d):d=e[13];let R;return e[14]!==d||e[15]!==a?(R=x.jsx("div",{className:a,children:d}),e[14]=d,e[15]=a,e[16]=R):R=e[16],R}let n;e[17]!==l||e[18]!==s?(n=$("relative overflow-hidden rounded-lg bg-muted",l,s),e[17]=l,e[18]=s,e[19]=n):n=e[19];let i;e[20]!==j||e[21]!==v?(i=j&&!v&&x.jsx("img",{src:j,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover"}),e[20]=j,e[21]=v,e[22]=i):i=e[22];let U;e[23]===Symbol.for("react.memo_cache_sentinel")?(U=a=>{D.current=a,a?.complete&&a.naturalWidth>0&&T()},e[23]=U):U=e[23];const L=v?"opacity-100":"opacity-0";let m;e[24]!==L?(m=$("absolute inset-0 w-full h-full object-cover transition-opacity duration-300",L),e[24]=L,e[25]=m):m=e[25];let u;e[26]!==C||e[27]!==g||e[28]!==m?(u=x.jsx("img",{ref:U,src:g,alt:C,loading:"lazy",decoding:"async",onLoad:z,onError:F,className:m}),e[26]=C,e[27]=g,e[28]=m,e[29]=u):u=e[29];let w;return e[30]!==k||e[31]!==i||e[32]!==u||e[33]!==n?(w=x.jsxs("div",{className:n,children:[i,u]},k),e[30]=k,e[31]=i,e[32]=u,e[33]=n,e[34]=w):w=e[34],w}export{ae as I};
