import{a as x,j as b}from"./tanstack-vendor-DRhT2kVp.js";import{c as X,a as M}from"./index-BTs5NH8z.js";import{j as Z}from"./media-vendor-CUSAIUeh.js";import{g as q,u as G,e as J}from"./feature-error-boundary--30YIiE6.js";const y=new Map,O=100;function P(I,e=32,t=32){const h=`${I}-${e}-${t}`,r=y.get(h);if(r)return r;try{const k=Z(I,e,t),a=document.createElement("canvas");a.width=e,a.height=t;const c=a.getContext("2d");if(!c)return null;const g=c.createImageData(e,t);g.data.set(k),c.putImageData(g,0,0);const n=a.toDataURL();if(y.size>=O){const s=y.keys().next().value;s&&y.delete(s)}return y.set(h,n),n}catch{return null}}function ae(I){const e=X.c(38),{item:t,maxWidth:h,maxHeight:r,alt:k,className:a,aspectRatio:c,showFallback:g}=I,n=h===void 0?300:h,s=c===void 0?"aspect-[2/3]":c,z=g===void 0?!0:g,[v,B]=x.useState(!1),[F,W]=x.useState(!1),C=x.useRef(null);let E;e[0]!==t||e[1]!==r||e[2]!==n?(E=q(t,n,r)??null,e[0]=t,e[1]=r,e[2]=n,e[3]=E):E=e[3];const o=G(E);let p;if(e[4]!==t){e:{const l=J(t);if(!l){p=null;break e}p=P(l)}e[4]=t,e[5]=p}else p=e[5];const j=p;let _;e[6]===Symbol.for("react.memo_cache_sentinel")?(_=()=>{B(!1),W(!1)},e[6]=_):_=e[6];let N;e[7]!==t.Id?(N=[t.Id],e[7]=t.Id,e[8]=N):N=e[8],x.useEffect(_,N);let U;e[9]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{C.current?.complete&&C.current.naturalWidth>0&&B(!0)},e[9]=U):U=e[9];let w;e[10]!==o?(w=[o],e[10]=o,e[11]=w):w=e[11],x.useEffect(U,w);let R;e[12]===Symbol.for("react.memo_cache_sentinel")?(R=()=>{B(!0)},e[12]=R):R=e[12];const K=R;let S;e[13]===Symbol.for("react.memo_cache_sentinel")?(S=()=>{W(!0)},e[13]=S):S=e[13];const T=S,$=k||t.Name||"Media item";if(!o||F){if(!z)return null;let l;e[14]!==s||e[15]!==a?(l=M("bg-muted flex items-center justify-center rounded-lg overflow-hidden",s,a),e[14]=s,e[15]=a,e[16]=l):l=e[16];const H=t.Name||"No image";let d;e[17]!==H?(d=b.jsx("span",{className:"text-muted-foreground text-xs text-center px-2 line-clamp-2",children:H}),e[17]=H,e[18]=d):d=e[18];let L;return e[19]!==l||e[20]!==d?(L=b.jsx("div",{className:l,children:d}),e[19]=l,e[20]=d,e[21]=L):L=e[21],L}let i;e[22]!==s||e[23]!==a?(i=M("relative overflow-hidden rounded-lg bg-muted",s,a),e[22]=s,e[23]=a,e[24]=i):i=e[24];let m;e[25]!==j||e[26]!==v?(m=j&&!v&&b.jsx("img",{src:j,alt:"","aria-hidden":"true",className:"absolute inset-0 w-full h-full object-cover"}),e[25]=j,e[26]=v,e[27]=m):m=e[27];const A=v?"opacity-100":"opacity-0";let f;e[28]!==A?(f=M("absolute inset-0 w-full h-full object-cover transition-opacity duration-300",A),e[28]=A,e[29]=f):f=e[29];let u;e[30]!==$||e[31]!==o||e[32]!==f?(u=b.jsx("img",{ref:C,src:o,alt:$,loading:"lazy",decoding:"async",onLoad:K,onError:T,className:f}),e[30]=$,e[31]=o,e[32]=f,e[33]=u):u=e[33];let D;return e[34]!==i||e[35]!==m||e[36]!==u?(D=b.jsxs("div",{className:i,children:[m,u]}),e[34]=i,e[35]=m,e[36]=u,e[37]=D):D=e[37],D}export{ae as I};
