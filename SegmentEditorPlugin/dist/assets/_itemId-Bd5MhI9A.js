const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jassub-BtnWmffD.js","assets/react-vendor-NRF3IDaz.js"])))=>i.map(i=>d[i]);
import{a as m,j as n,v as Cr,x as Nr}from"./tanstack-vendor-DRhT2kVp.js";import{j as mr,c as He,u as Lt,a as Q,k as Qe,D as qs,l as Js,m as Qs,n as vs,B as Oe,o as Ss,p as Ts,q as ks,P as ys,r as gr,_ as Ir,s as Pr,t as Bs,v as Os,J as Rr,w as Ar,x as gs,y as Ct,z as Dr,A as $t,E as zt,F as Mr,G as pr,H as Lr,I as Fr,K as $r,L as Vs,N as zr,O as Ks,Q as hr,T as ws,U as Ur,W as Or,X as Vr,Y as Hr,Z as Br,$ as Kr,a0 as bs,a1 as Gr,a2 as Wr,a3 as Yr,a4 as qr,a5 as Jr,a6 as Qr,a7 as Xr,a8 as Zr,a9 as fs,aa as Xs,ab as Zs,h as en,S as Ls}from"./index-BTs5NH8z.js";import{u as ps}from"./i18n-vendor-fVnzc7mj.js";import{aq as tn,aj as sn,ar as er,C as Fs,as as rn,at as nn,P as Hs,au as an,av as ln,aw as on,ax as cn,ay as un,az as dn,aA as fn,aB as mn,x as gn,R as $s,aC as pn,aD as yr,aE as xr,aF as hn,j as yn,l as xn,m as bn,n as vn,k as Sn,o as Tn,aG as br,aH as kn,L as wn}from"./ui-vendor-DfZQjXAX.js";import{s as zs,a as tr,b as En,c as _n,d as jn,g as vr,u as Cn,F as Nn}from"./feature-error-boundary--30YIiE6.js";import{H as ms}from"./hls-vendor-Cp2x8l1r.js";import{a as Sr,S as In}from"./async-state-Z52W-Y0r.js";import{R as Pn}from"./route-error-fallback-tGnS9Tsr.js";import{u as Rn}from"./use-vibrant-color-BVfYoRtN.js";import"./react-vendor-NRF3IDaz.js";import"./jellyfin-vendor-C-_X6ALD.js";import"./media-vendor-CUSAIUeh.js";const{KEYBOARD_STEP_FINE:An,KEYBOARD_STEP_COARSE:Dn}=mr;function Gs(s,t,e){const{min:r,max:a,value:l,gap:i=0,stepFine:u=An,stepCoarse:c=Dn}=e,f=t?c:u,g=a-i;let o=l,y=!0;switch(s){case"ArrowLeft":o=Math.max(r,l-f);break;case"ArrowRight":o=Math.min(g,l+f);break;case"Home":o=r;break;case"End":o=g;break;default:y=!1}return{handled:y,newValue:o}}function Mn(s,t,e,r,a){return Gs(s,t,{min:0,max:r,value:e,gap:a})}function Ln(s,t,e,r,a,l){const i=Gs(s,t,{min:e,max:a,value:r,gap:l});return s==="Home"?i.newValue=e+l:s==="End"&&(i.newValue=a),i}function Fn(s){return s?s instanceof HTMLInputElement||s instanceof HTMLTextAreaElement||s instanceof HTMLElement&&s.isContentEditable:!1}const $n=5,zn=10,Un=s=>s.vibrantColors;function On(s){const t=He.c(92),{currentTime:e,duration:r,buffered:a,onSeek:l,className:i}=s,u=a===void 0?0:a,c=Lt(Un),f=m.useRef(null),[g,o]=m.useState(!1),[y,S]=m.useState(null),[h,w]=m.useState(0),T=r>0?e/r*100:0,p=r>0?u/r*100:0;let E;t[0]!==r?(E=$=>{const J=f.current;if(!J||r<=0)return 0;const V=J.getBoundingClientRect();return Math.max(0,Math.min($-V.left,V.width))/V.width*r},t[0]=r,t[1]=E):E=t[1];const d=E;let j;t[2]!==d||t[3]!==l?(j=$=>{$.preventDefault(),$.target.setPointerCapture($.pointerId),o(!0),l(d($.clientX))},t[2]=d,t[3]=l,t[4]=j):j=t[4];const x=j;let I;t[5]!==d||t[6]!==g||t[7]!==l?(I=$=>{const J=f.current;if(!J)return;const V=J.getBoundingClientRect(),Se=Math.max(0,Math.min($.clientX-V.left,V.width));S(d($.clientX)),w(Se),g&&l(d($.clientX))},t[5]=d,t[6]=g,t[7]=l,t[8]=I):I=t[8];const R=I;let D;t[9]===Symbol.for("react.memo_cache_sentinel")?(D=$=>{$.target.releasePointerCapture($.pointerId),o(!1)},t[9]=D):D=t[9];const k=D;let B;t[10]===Symbol.for("react.memo_cache_sentinel")?(B=()=>{S(null)},t[10]=B):B=t[10];const N=B;let _;t[11]!==e||t[12]!==r||t[13]!==l?(_=$=>{if(r<=0)return;const J=Gs($.key,$.shiftKey,{min:0,max:r,value:e,stepFine:$n,stepCoarse:zn});J.handled&&($.preventDefault(),l(J.newValue))},t[11]=e,t[12]=r,t[13]=l,t[14]=_):_=t[14];const C=_;let L;t[15]!==c?(L=c?{backgroundColor:c.primary+"30"}:void 0,t[15]=c,t[16]=L):L=t[16];const A=L;let W;t[17]!==T||t[18]!==c?.accent?(W=()=>({width:`${T}%`,backgroundColor:c?.accent}),t[17]=T,t[18]=c?.accent,t[19]=W):W=t[19],c?.accent;let U;t[20]!==W?(U=W(),t[20]=W,t[21]=U):U=t[21];const re=U,Y=`${T}%`,K=c?.accent,M=c?`0 0 0 2px ${c.primary}40, 0 4px 6px -1px rgba(0, 0, 0, 0.1)`:void 0;let ne;t[22]!==Y||t[23]!==K||t[24]!==M?(ne={left:Y,backgroundColor:K,boxShadow:M,transform:"translate(-50%, -50%)"},t[22]=Y,t[23]=K,t[24]=M,t[25]=ne):ne=t[25];const X=ne,ae=`${p}%`;let G;t[26]!==ae?(G={width:ae},t[26]=ae,t[27]=G):G=t[27];const Te=G;let z;t[28]!==h?(z={left:h,transform:"translateX(-50%)"},t[28]=h,t[29]=z):z=t[29];const Z=z;let ke;t[30]!==i?(ke=Q("flex items-center gap-3",i),t[30]=i,t[31]=ke):ke=t[31];let le;t[32]!==e?(le=Qe(e),t[32]=e,t[33]=le):le=t[33];let ge;t[34]!==le?(ge=n.jsx("span",{className:"text-xs text-muted-foreground font-mono min-w-[var(--spacing-time-display)]",children:le}),t[34]=le,t[35]=ge):ge=t[35];let be;t[36]===Symbol.for("react.memo_cache_sentinel")?(be={contain:"layout style"},t[36]=be):be=t[36];let b;t[37]!==r?(b=Math.round(r),t[37]=r,t[38]=b):b=t[38];let je;t[39]!==e?(je=Math.round(e),t[39]=e,t[40]=je):je=t[40];let ee;t[41]!==e?(ee=Qe(e),t[41]=e,t[42]=ee):ee=t[42];let Re;t[43]!==r?(Re=Qe(r),t[43]=r,t[44]=Re):Re=t[44];const ce=`${ee} of ${Re}`,Ce=!c&&"bg-muted";let pe;t[45]!==Ce?(pe=Q("absolute inset-0 rounded-full overflow-hidden",Ce),t[45]=Ce,t[46]=pe):pe=t[46];let ye;t[47]!==Te?(ye=n.jsx("div",{className:"absolute inset-y-0 left-0 bg-muted-foreground/30 rounded-full",style:Te}),t[47]=Te,t[48]=ye):ye=t[48];const we=!c&&"bg-primary";let Ee;t[49]!==we?(Ee=Q("absolute inset-y-0 left-0 rounded-full",we),t[49]=we,t[50]=Ee):Ee=t[50];let ue;t[51]!==re||t[52]!==Ee?(ue=n.jsx("div",{className:Ee,style:re}),t[51]=re,t[52]=Ee,t[53]=ue):ue=t[53];let F;t[54]!==pe||t[55]!==ye||t[56]!==ue||t[57]!==A?(F=n.jsxs("div",{className:pe,style:A,children:[ye,ue]}),t[54]=pe,t[55]=ye,t[56]=ue,t[57]=A,t[58]=F):F=t[58];const Ae=y!==null?"opacity-100":"opacity-0";let De;t[59]!==Ae?(De=Q("absolute top-0 w-0.5 h-full bg-white/50 pointer-events-none transition-opacity",Ae),t[59]=Ae,t[60]=De):De=t[60];let ve;t[61]!==Z||t[62]!==De?(ve=n.jsx("div",{className:De,style:Z}),t[61]=Z,t[62]=De,t[63]=ve):ve=t[63];const Me=!c&&"bg-primary";let ie;t[64]!==Me?(ie=Q("absolute top-1/2 w-4 h-4 rounded-full shadow-md transition-transform group-hover:scale-110",Me),t[64]=Me,t[65]=ie):ie=t[65];let q;t[66]!==ie||t[67]!==X?(q=n.jsx("div",{className:ie,style:X}),t[66]=ie,t[67]=X,t[68]=q):q=t[68];let se;t[69]!==Z||t[70]!==y?(se=y!==null&&n.jsx("div",{className:"absolute -top-8 bg-popover text-popover-foreground text-xs px-2 py-1 rounded shadow-lg pointer-events-none",style:Z,children:Qe(y)}),t[69]=Z,t[70]=y,t[71]=se):se=t[71];let oe;t[72]!==C||t[73]!==x||t[74]!==R||t[75]!==b||t[76]!==je||t[77]!==ce||t[78]!==F||t[79]!==ve||t[80]!==q||t[81]!==se?(oe=n.jsxs("div",{ref:f,className:"relative flex-1 h-2 cursor-pointer group touch-none",style:be,role:"slider","aria-label":"Video progress","aria-valuemin":0,"aria-valuemax":b,"aria-valuenow":je,"aria-valuetext":ce,"aria-orientation":"horizontal",tabIndex:0,onPointerDown:x,onPointerMove:R,onPointerUp:k,onPointerLeave:N,onKeyDown:C,children:[F,ve,q,se]}),t[72]=C,t[73]=x,t[74]=R,t[75]=b,t[76]=je,t[77]=ce,t[78]=F,t[79]=ve,t[80]=q,t[81]=se,t[82]=oe):oe=t[82];let de;t[83]!==r?(de=Qe(r),t[83]=r,t[84]=de):de=t[84];let xe;t[85]!==de?(xe=n.jsx("span",{className:"text-xs text-muted-foreground font-mono min-w-[var(--spacing-time-display)] text-right",children:de}),t[85]=de,t[86]=xe):xe=t[86];let fe;return t[87]!==ke||t[88]!==ge||t[89]!==oe||t[90]!==xe?(fe=n.jsxs("div",{className:ke,children:[ge,oe,xe]}),t[87]=ke,t[88]=ge,t[89]=oe,t[90]=xe,t[91]=fe):fe=t[91],fe}const Vn="size-5 sm:size-6",Hn=s=>s?{color:s}:void 0,Bn=(s,t)=>Q("!size-12 sm:!size-12 border-2 transition-all duration-200 ease-out","",!t&&"border-border"),Kn=m.memo(function(t){const e=He.c(56),{trackState:r,onSelectAudio:a,onSelectSubtitle:l,strategy:i,disabled:u,getButtonStyle:c,iconColor:f,hasColors:g,className:o}=t,y=u===void 0?!1:u,S=g===void 0?!1:g,{t:h}=ps(),{audioTracks:w,subtitleTracks:T,activeAudioIndex:p,activeSubtitleIndex:E}=r,d=w.length>0,j=T.length>0,x=d||j,I=i==="direct",R=I?tn:sn;let D;e[0]!==a?(D=z=>{a(z)},e[0]=a,e[1]=D):D=e[1];const k=D;let B;e[2]!==l?(B=z=>{l(z)},e[2]=l,e[3]=B):B=e[3];const N=B;let _;e[4]!==h?(_=h("player.tracks.selector","Audio and subtitle tracks"),e[4]=h,e[5]=_):_=e[5];const C=y||!x;let L;e[6]!==c?(L=c?.(),e[6]=c,e[7]=L):L=e[7];let A;e[8]!==o||e[9]!==S?(A=Q(Bn(!1,S),o),e[8]=o,e[9]=S,e[10]=A):A=e[10];let W;e[11]!==_||e[12]!==C||e[13]!==L||e[14]!==A?(W=n.jsx(Oe,{variant:"outline","aria-label":_,disabled:C,style:L,className:A}),e[11]=_,e[12]=C,e[13]=L,e[14]=A,e[15]=W):W=e[15];let U;e[16]!==f?(U=Hn(f),e[16]=f,e[17]=U):U=e[17];let re;e[18]!==U?(re=n.jsx(er,{className:Vn,strokeWidth:2.5,"aria-hidden":"true",style:U}),e[18]=U,e[19]=re):re=e[19];let Y;e[20]!==re||e[21]!==W?(Y=n.jsx(Ss,{render:W,children:re}),e[20]=re,e[21]=W,e[22]=Y):Y=e[22];let K;e[23]!==R||e[24]!==x||e[25]!==I||e[26]!==i||e[27]!==h?(K=i&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"px-3 py-2",children:n.jsxs("div",{className:Q("inline-flex items-center gap-1.5 px-2 py-1 rounded-md text-xs font-medium",I?"bg-emerald-500/10 text-emerald-600 border border-emerald-500/20":"bg-blue-500/10 text-blue-600 border border-blue-500/20"),role:"status","aria-label":I?h("player.strategy.direct","Direct Play - Original quality, no transcoding"):h("player.strategy.hls","HLS Streaming - Transcoded for compatibility"),children:[n.jsx(R,{className:"size-3","aria-hidden":"true"}),n.jsx("span",{children:I?h("player.strategy.directLabel","Direct Play"):h("player.strategy.hlsLabel","HLS Transcode")})]})}),x&&n.jsx(qs,{})]}),e[23]=R,e[24]=x,e[25]=I,e[26]=i,e[27]=h,e[28]=K):K=e[28];let M;e[29]!==p||e[30]!==w||e[31]!==k||e[32]!==d||e[33]!==h?(M=d&&n.jsxs(Js,{children:[n.jsxs(Qs,{className:"flex items-center gap-2",children:[n.jsx(er,{className:"size-4","aria-hidden":"true"}),h("player.tracks.audio","Audio")]}),w.map(z=>{const Z=z.index===p;return n.jsxs(vs,{onClick:()=>k(z.index),className:Q("flex items-center justify-between gap-2",Z&&"bg-accent"),"aria-selected":Z,children:[n.jsx("span",{className:"truncate",children:z.displayTitle}),Z&&n.jsx(Fs,{className:"size-4 shrink-0 text-primary","aria-hidden":"true"})]},`audio-${z.index}`)})]}),e[29]=p,e[30]=w,e[31]=k,e[32]=d,e[33]=h,e[34]=M):M=e[34];let ne;e[35]!==d||e[36]!==j?(ne=d&&j&&n.jsx(qs,{}),e[35]=d,e[36]=j,e[37]=ne):ne=e[37];let X;e[38]!==E||e[39]!==N||e[40]!==j||e[41]!==T||e[42]!==h?(X=j&&n.jsxs(Js,{children:[n.jsxs(Qs,{className:"flex items-center gap-2",children:[n.jsx(rn,{className:"size-4","aria-hidden":"true"}),h("player.tracks.subtitle","Subtitles")]}),n.jsxs(vs,{onClick:()=>N(null),className:Q("flex items-center justify-between gap-2",E===null&&"bg-accent"),"aria-selected":E===null,children:[n.jsx("span",{children:h("player.tracks.off","Off")}),E===null&&n.jsx(Fs,{className:"size-4 shrink-0 text-primary","aria-hidden":"true"})]}),T.map(z=>{const Z=z.index===E;return n.jsxs(vs,{onClick:()=>N(z.index),className:Q("flex items-center justify-between gap-2",Z&&"bg-accent"),"aria-selected":Z,children:[n.jsx("span",{className:"truncate",children:z.displayTitle}),Z&&n.jsx(Fs,{className:"size-4 shrink-0 text-primary","aria-hidden":"true"})]},`subtitle-${z.index}`)})]}),e[38]=E,e[39]=N,e[40]=j,e[41]=T,e[42]=h,e[43]=X):X=e[43];let ae;e[44]!==x||e[45]!==h?(ae=!x&&n.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:h("player.tracks.noTracks","No tracks available")}),e[44]=x,e[45]=h,e[46]=ae):ae=e[46];let G;e[47]!==K||e[48]!==M||e[49]!==ne||e[50]!==X||e[51]!==ae?(G=n.jsxs(Ts,{align:"start",className:"min-w-[240px] max-h-[400px] overflow-y-auto",children:[K,M,ne,X,ae]}),e[47]=K,e[48]=M,e[49]=ne,e[50]=X,e[51]=ae,e[52]=G):G=e[52];let Te;return e[53]!==Y||e[54]!==G?(Te=n.jsxs(ks,{children:[Y,G]}),e[53]=Y,e[54]=G,e[55]=Te):Te=e[55],Te}),{SKIP_TIMES:Gn}=ys,kt="size-5 sm:size-6",jt=s=>s?{color:s}:void 0,Wn=Object.freeze([{label:"Play/Pause",keys:["Space"]},{label:"Skip back/forward",keys:["A","D"]},{label:"Change skip time",keys:["W","S"]},{label:"Set start time",keys:["E"]},{label:"Set end time",keys:["F"]},{label:"Toggle mute",keys:["M"]}]),Ft=(s,t)=>Q("!size-12 sm:!size-12 border-2 transition-all duration-200 ease-out",s?"rounded-[30%] duration-300":"",!t&&(s?"border-primary":"border-border")),Yn=m.memo(function(t){const e=He.c(190),{isPlaying:r,isMuted:a,volume:l,skipTimeIndex:i,vibrantColors:u,hasColors:c,iconColor:f,getButtonStyle:g,onTogglePlay:o,onToggleMute:y,onVolumeChange:S,onCreateSegment:h,onPushStartTimestamp:w,onPushEndTimestamp:T,onSkipTimeChange:p,trackState:E,onSelectAudioTrack:d,onSelectSubtitleTrack:j,isTrackSelectorDisabled:x,strategy:I,isFullscreen:R,onToggleFullscreen:D}=t,{t:k}=ps();let B;e[0]!==S?(B=Ue=>{S(parseFloat(Ue.target.value))},e[0]=S,e[1]=B):B=e[1];const N=B;let _;e[2]!==k?(_=k("player.controls","Video player controls"),e[2]=k,e[3]=_):_=e[3];let C;e[4]!==r||e[5]!==k?(C=r?k("accessibility.player.paused","Pause video"):k("accessibility.playPause","Play video"),e[4]=r,e[5]=k,e[6]=C):C=e[6];let L;e[7]!==g||e[8]!==r?(L=g(r),e[7]=g,e[8]=r,e[9]=L):L=e[9];let A;e[10]!==c||e[11]!==r?(A=Q(Ft(r,c),!r&&"rounded-full"),e[10]=c,e[11]=r,e[12]=A):A=e[12];let W;e[13]!==f||e[14]!==r||e[15]!==u?.accentText?(W=r?n.jsx(nn,{className:kt,fill:u?.accentText??"currentColor",strokeWidth:0,"aria-hidden":"true"}):n.jsx(Hs,{className:kt,fill:f??"currentColor",strokeWidth:0,"aria-hidden":"true",style:jt(f)}),e[13]=f,e[14]=r,e[15]=u?.accentText,e[16]=W):W=e[16];let U;e[17]!==r||e[18]!==o||e[19]!==C||e[20]!==L||e[21]!==A||e[22]!==W?(U=n.jsx(Oe,{variant:"outline",onClick:o,"aria-label":C,"aria-pressed":r,style:L,className:A,children:W}),e[17]=r,e[18]=o,e[19]=C,e[20]=L,e[21]=A,e[22]=W,e[23]=U):U=e[23];let re;e[24]!==a||e[25]!==k||e[26]!==l?(re=a||l===0?k("accessibility.player.muted","Volume muted"):k("player.volume","Volume"),e[24]=a,e[25]=k,e[26]=l,e[27]=re):re=e[27];let Y;e[28]!==g?(Y=g(),e[28]=g,e[29]=Y):Y=e[29];let K;e[30]!==c?(K=Ft(!1,c),e[30]=c,e[31]=K):K=e[31];let M;e[32]!==K||e[33]!==re||e[34]!==Y?(M=n.jsx(Oe,{variant:"outline","aria-label":re,style:Y,className:K}),e[32]=K,e[33]=re,e[34]=Y,e[35]=M):M=e[35];let ne;e[36]!==f||e[37]!==a||e[38]!==l?(ne=a||l===0?n.jsx(on,{className:kt,strokeWidth:2.5,"aria-hidden":"true",style:jt(f)}):n.jsx(cn,{className:kt,strokeWidth:2.5,"aria-hidden":"true",style:jt(f)}),e[36]=f,e[37]=a,e[38]=l,e[39]=ne):ne=e[39];let X;e[40]!==M||e[41]!==ne?(X=n.jsx(Ss,{render:M,children:ne}),e[40]=M,e[41]=ne,e[42]=X):X=e[42];const ae=a?0:l;let G;e[43]!==k?(G=k("player.volumeSlider"),e[43]=k,e[44]=G):G=e[44];let Te;e[45]!==a||e[46]!==l?(Te=Math.round((a?0:l)*100),e[45]=a,e[46]=l,e[47]=Te):Te=e[47];let z;e[48]!==a||e[49]!==l?(z=Math.round((a?0:l)*100),e[48]=a,e[49]=l,e[50]=z):z=e[50];const Z=`${z}%`;let ke;e[51]!==N||e[52]!==ae||e[53]!==G||e[54]!==Te||e[55]!==Z?(ke=n.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:ae,onChange:N,"aria-label":G,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Te,"aria-valuetext":Z,className:"h-24 w-2 appearance-none bg-muted rounded-full cursor-pointer [writing-mode:vertical-lr] [direction:rtl]"}),e[51]=N,e[52]=ae,e[53]=G,e[54]=Te,e[55]=Z,e[56]=ke):ke=e[56];let le;e[57]!==a||e[58]!==k?(le=k(a?"player.unmute":"player.mute"),e[57]=a,e[58]=k,e[59]=le):le=e[59];let ge;e[60]!==y||e[61]!==le?(ge=n.jsx(Oe,{variant:"ghost",size:"sm",onClick:y,className:"text-xs",children:le}),e[60]=y,e[61]=le,e[62]=ge):ge=e[62];let be;e[63]!==ke||e[64]!==ge?(be=n.jsx(Ts,{align:"start",className:"p-4",children:n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[ke,ge]})}),e[63]=ke,e[64]=ge,e[65]=be):be=e[65];let b;e[66]!==X||e[67]!==be?(b=n.jsxs(ks,{children:[X,be]}),e[66]=X,e[67]=be,e[68]=b):b=e[68];let je;e[69]!==k?(je=k("editor.newSegment"),e[69]=k,e[70]=je):je=e[70];let ee;e[71]!==g?(ee=g(),e[71]=g,e[72]=ee):ee=e[72];let Re;e[73]!==c?(Re=Ft(!1,c),e[73]=c,e[74]=Re):Re=e[74];let ce;e[75]!==je||e[76]!==ee||e[77]!==Re?(ce=n.jsx(Oe,{variant:"outline","aria-label":je,style:ee,className:Re}),e[75]=je,e[76]=ee,e[77]=Re,e[78]=ce):ce=e[78];let Ce;e[79]!==f?(Ce=jt(f),e[79]=f,e[80]=Ce):Ce=e[80];let pe;e[81]!==Ce?(pe=n.jsx(un,{className:kt,strokeWidth:3,"aria-hidden":"true",style:Ce}),e[81]=Ce,e[82]=pe):pe=e[82];let ye;e[83]!==ce||e[84]!==pe?(ye=n.jsx(Ss,{render:ce,children:pe}),e[83]=ce,e[84]=pe,e[85]=ye):ye=e[85];let we;e[86]!==h?(we=gr.map(Ue=>n.jsx(vs,{onClick:()=>h(Ue),children:Ue},Ue)),e[86]=h,e[87]=we):we=e[87];let Ee;e[88]!==we?(Ee=n.jsx(Ts,{align:"start",children:we}),e[88]=we,e[89]=Ee):Ee=e[89];let ue;e[90]!==ye||e[91]!==Ee?(ue=n.jsxs(ks,{children:[ye,Ee]}),e[90]=ye,e[91]=Ee,e[92]=ue):ue=e[92];let F;e[93]!==k?(F=k("accessibility.seekToStart"),e[93]=k,e[94]=F):F=e[94];let Ae;e[95]!==k?(Ae=k("accessibility.seekToStart"),e[95]=k,e[96]=Ae):Ae=e[96];const De=`${Ae} (E)`;let ve;e[97]!==g?(ve=g(),e[97]=g,e[98]=ve):ve=e[98];let Me;e[99]!==c?(Me=Ft(!1,c),e[99]=c,e[100]=Me):Me=e[100];let ie;e[101]!==f?(ie=jt(f),e[101]=f,e[102]=ie):ie=e[102];let q;e[103]!==ie?(q=n.jsx(dn,{className:kt,strokeWidth:3,"aria-hidden":"true",style:ie}),e[103]=ie,e[104]=q):q=e[104];let se;e[105]!==w||e[106]!==F||e[107]!==De||e[108]!==ve||e[109]!==Me||e[110]!==q?(se=n.jsx(Oe,{variant:"outline",onClick:w,"aria-label":F,title:De,style:ve,className:Me,children:q}),e[105]=w,e[106]=F,e[107]=De,e[108]=ve,e[109]=Me,e[110]=q,e[111]=se):se=e[111];let oe;e[112]!==k?(oe=k("accessibility.seekToEnd"),e[112]=k,e[113]=oe):oe=e[113];let de;e[114]!==k?(de=k("accessibility.seekToEnd"),e[114]=k,e[115]=de):de=e[115];const xe=`${de} (F)`;let fe;e[116]!==g?(fe=g(),e[116]=g,e[117]=fe):fe=e[117];let $;e[118]!==c?($=Ft(!1,c),e[118]=c,e[119]=$):$=e[119];let J;e[120]!==f?(J=jt(f),e[120]=f,e[121]=J):J=e[121];let V;e[122]!==J?(V=n.jsx(fn,{className:kt,strokeWidth:3,"aria-hidden":"true",style:J}),e[122]=J,e[123]=V):V=e[123];let Se;e[124]!==T||e[125]!==oe||e[126]!==xe||e[127]!==fe||e[128]!==$||e[129]!==V?(Se=n.jsx(Oe,{variant:"outline",onClick:T,"aria-label":oe,title:xe,style:fe,className:$,children:V}),e[124]=T,e[125]=oe,e[126]=xe,e[127]=fe,e[128]=$,e[129]=V,e[130]=Se):Se=e[130];let ze;e[131]!==g||e[132]!==c||e[133]!==f||e[134]!==x||e[135]!==d||e[136]!==j||e[137]!==I||e[138]!==E?(ze=E&&d&&j&&n.jsx(Kn,{trackState:E,onSelectAudio:d,onSelectSubtitle:j,strategy:I,disabled:x,getButtonStyle:g,iconColor:f,hasColors:c}),e[131]=g,e[132]=c,e[133]=f,e[134]=x,e[135]=d,e[136]=j,e[137]=I,e[138]=E,e[139]=ze):ze=e[139];let Ne;e[140]!==b||e[141]!==ue||e[142]!==se||e[143]!==Se||e[144]!==ze||e[145]!==U?(Ne=n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[U,b,ue,se,Se,ze]}),e[140]=b,e[141]=ue,e[142]=se,e[143]=Se,e[144]=ze,e[145]=U,e[146]=Ne):Ne=e[146];let Be;e[147]===Symbol.for("react.memo_cache_sentinel")?(Be=n.jsx("div",{className:"flex-1"}),e[147]=Be):Be=e[147];let Le;e[148]!==g||e[149]!==c||e[150]!==f||e[151]!==R||e[152]!==D||e[153]!==k?(Le=D&&n.jsx(Oe,{variant:"outline",onClick:D,"aria-label":R?k("player.exitFullscreen","Exit fullscreen"):k("player.fullscreen","Fullscreen"),style:g(),className:Ft(!1,c),children:R?n.jsx(an,{className:kt,strokeWidth:2.5,"aria-hidden":"true",style:jt(f)}):n.jsx(ln,{className:kt,strokeWidth:2.5,"aria-hidden":"true",style:jt(f)})}),e[148]=g,e[149]=c,e[150]=f,e[151]=R,e[152]=D,e[153]=k,e[154]=Le):Le=e[154];let We;e[155]!==k?(We=k("accessibility.keyboardShortcuts"),e[155]=k,e[156]=We):We=e[156];let Fe;e[157]!==g?(Fe=g(),e[157]=g,e[158]=Fe):Fe=e[158];let Ke;e[159]!==c?(Ke=Ft(!1,c),e[159]=c,e[160]=Ke):Ke=e[160];let Ie;e[161]!==We||e[162]!==Fe||e[163]!==Ke?(Ie=n.jsx(Oe,{variant:"outline","aria-label":We,style:Fe,className:Ke}),e[161]=We,e[162]=Fe,e[163]=Ke,e[164]=Ie):Ie=e[164];let he;e[165]!==f?(he=jt(f),e[165]=f,e[166]=he):he=e[166];let Pe;e[167]!==he?(Pe=n.jsx(mn,{className:kt,strokeWidth:3,"aria-hidden":"true",style:he}),e[167]=he,e[168]=Pe):Pe=e[168];let _e;e[169]!==Ie||e[170]!==Pe?(_e=n.jsx(Ss,{render:Ie,children:Pe}),e[169]=Ie,e[170]=Pe,e[171]=_e):_e=e[171];let Ve;e[172]===Symbol.for("react.memo_cache_sentinel")?(Ve=n.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",id:"skip-duration-label",children:"Skip Duration"}),e[172]=Ve):Ve=e[172];let $e;e[173]!==p||e[174]!==i?($e=Gn.map((Ue,lt)=>n.jsxs("button",{onClick:()=>p(lt),className:Q("px-3 py-1.5 rounded-md text-sm font-medium transition-colors",lt===i?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80 text-foreground"),role:"radio","aria-checked":lt===i,"aria-label":`Skip ${Ue} seconds`,children:[Ue,"s"]},Ue)),e[173]=p,e[174]=i,e[175]=$e):$e=e[175];let P;e[176]!==$e?(P=n.jsxs("div",{className:"mb-4 pb-4 border-b border-border",children:[Ve,n.jsx("div",{className:"flex flex-wrap gap-1.5",role:"radiogroup","aria-labelledby":"skip-duration-label",children:$e})]}),e[176]=$e,e[177]=P):P=e[177];let H;e[178]===Symbol.for("react.memo_cache_sentinel")?(H=n.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Keyboard Shortcuts"}),e[178]=H):H=e[178];let te;e[179]===Symbol.for("react.memo_cache_sentinel")?(te=n.jsxs("div",{children:[H,n.jsx("div",{className:"space-y-1.5 text-sm",children:Wn.map(Jn)})]}),e[179]=te):te=e[179];let O;e[180]!==P?(O=n.jsxs(Ts,{align:"end",className:"p-4 min-w-[280px]",children:[P,te]}),e[180]=P,e[181]=O):O=e[181];let Ge;e[182]!==_e||e[183]!==O?(Ge=n.jsxs(ks,{children:[_e,O]}),e[182]=_e,e[183]=O,e[184]=Ge):Ge=e[184];let Je;return e[185]!==_||e[186]!==Ne||e[187]!==Le||e[188]!==Ge?(Je=n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",role:"toolbar","aria-label":_,children:[Ne,Be,Le,Ge]}),e[185]=_,e[186]=Ne,e[187]=Le,e[188]=Ge,e[189]=Je):Je=e[189],Je});function qn(s){return n.jsx("kbd",{className:"px-2 py-0.5 bg-muted rounded text-xs font-mono ml-1",children:s},s)}function Jn(s){const{label:t,keys:e}=s;return n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-muted-foreground",children:t}),n.jsx("span",{children:e.map(qn)})]},t)}const{SKIP_TIMES:Qn,DEFAULT_SKIP_TIME_INDEX:Xn}=ys,Zn={isPlaying:!1,currentTime:0,duration:0,buffered:0,volume:1,isMuted:!1,skipTimeIndex:Xn,playerError:null,isRecovering:!1,subtitleOffset:0};function ea(s,t){switch(t.type){case"PLAYBACK_UPDATE":return s.currentTime===t.currentTime?s:{...s,currentTime:t.currentTime};case"MEDIA_LOADED":return s.duration===t.duration?s:{...s,duration:t.duration};case"BUFFER_UPDATE":return s.buffered===t.buffered?s:{...s,buffered:t.buffered};case"PLAY_STATE":return s.isPlaying===t.isPlaying?s:{...s,isPlaying:t.isPlaying};case"VOLUME_CHANGE":return s.volume===t.volume&&s.isMuted===t.isMuted?s:{...s,volume:t.volume,isMuted:t.isMuted};case"SKIP_TIME_CHANGE":return s.skipTimeIndex===t.skipTimeIndex?s:{...s,skipTimeIndex:t.skipTimeIndex};case"ERROR_STATE":return{...s,playerError:t.error,isRecovering:t.isRecovering};case"RECOVERY_START":return{...s,isRecovering:!0};case"CYCLE_SKIP":{const e=Math.max(0,Math.min(Qn.length-1,s.skipTimeIndex+t.direction));return e===s.skipTimeIndex?s:{...s,skipTimeIndex:e}}case"SUBTITLE_OFFSET_CHANGE":return s.subtitleOffset===t.offset?s:{...s,subtitleOffset:t.offset}}}const sr={english:"en",german:"de",french:"fr",spanish:"es",italian:"it",portuguese:"pt",russian:"ru",japanese:"ja",chinese:"zh",korean:"ko",dutch:"nl",polish:"pl",swedish:"sv",norwegian:"no",danish:"da",finnish:"fi",arabic:"ar",hebrew:"he",hindi:"hi",thai:"th",vietnamese:"vi",indonesian:"id",turkish:"tr",greek:"el",czech:"cs",hungarian:"hu",romanian:"ro",ukrainian:"uk",deutsch:"de",français:"fr",español:"es",italiano:"it",português:"pt",русский:"ru",日本語:"ja",中文:"zh",한국어:"ko",nederlands:"nl",polski:"pl",svenska:"sv",norsk:"no",dansk:"da",suomi:"fi",العربية:"ar",עברית:"he",हिन्दी:"hi",ไทย:"th",tiếng_việt:"vi",türkçe:"tr",ελληνικά:"el",čeština:"cs",magyar:"hu",română:"ro",українська:"uk"},rr={eng:"en",deu:"de",ger:"de",fra:"fr",fre:"fr",spa:"es",ita:"it",por:"pt",rus:"ru",jpn:"ja",zho:"zh",chi:"zh",kor:"ko",nld:"nl",dut:"nl",pol:"pl",swe:"sv",nor:"no",dan:"da",fin:"fi",ara:"ar",heb:"he",hin:"hi",tha:"th",vie:"vi",ind:"id",tur:"tr",ell:"el",gre:"el",ces:"cs",cze:"cs",hun:"hu",ron:"ro",rum:"ro",ukr:"uk",und:"und"};function nr(s){if(!s)return null;const t=s.toLowerCase().trim();if(!t)return null;if(sr[t])return sr[t];if(rr[t])return rr[t];const e=t.indexOf("-");return e>0?t.slice(0,e):t.slice(0,2)}function Ws(s,t){const e=nr(s),r=nr(t);return!e||!r?!1:e===r}const ta={currentTime:0,volume:1,muted:!1,paused:!0};function ar(s){return s?{currentTime:s.currentTime,volume:s.volume,muted:s.muted,paused:s.paused}:{...ta}}function lr(s,t){s&&(s.volume=t.volume,s.muted=t.muted,t.currentTime>0&&isFinite(t.currentTime)&&(s.currentTime=t.currentTime))}const{RECOVERY_TIMEOUT_MS:sa}=ys,ra={testBandwidth:!1,enableWorker:!0,lowLatencyMode:!1,startLevel:-1,maxBufferLength:30,maxMaxBufferLength:60,abrEwmaDefaultEstimate:5e5},ir=(s,t,e,r)=>({type:s,message:e(t),recoverable:r});function na({videoUrl:s,onError:t,onRecoveryStart:e,onRecoveryEnd:r,t:a}){const l=m.useRef(null),i=m.useRef(null),u=m.useRef(null),c=m.useRef(!0),f=m.useRef({onError:t,onRecoveryStart:e,onRecoveryEnd:r,t:a});f.current={onError:t,onRecoveryStart:e,onRecoveryEnd:r,t:a};const g=m.useCallback(()=>{u.current&&(clearTimeout(u.current),u.current=null)},[]),o=m.useCallback(()=>{g(),i.current&&(i.current.destroy(),i.current=null)},[g]);m.useEffect(()=>{const S=l.current;if(!(!S||!s)){if(c.current=!0,f.current.onError(null),o(),ms.isSupported()){const h=new ms(ra);h.attachMedia(S);const w=(T,p,E)=>{if(!c.current)return;const{onError:d,onRecoveryStart:j,onRecoveryEnd:x,t:I}=f.current;d(ir(T,p,I,!0)),j(),E(),g(),u.current=setTimeout(()=>{c.current&&x()},sa)};h.on(ms.Events.ERROR,(T,p)=>{if(!c.current||!p.fatal)return;const{t:E}=f.current;switch(p.type){case ms.ErrorTypes.NETWORK_ERROR:w("network","player.error.network",()=>h.startLoad());break;case ms.ErrorTypes.MEDIA_ERROR:w("media","player.error.media",()=>h.recoverMediaError());break;default:f.current.onError(ir("unknown","player.error.unknown",E,!1))}}),h.on(ms.Events.MANIFEST_PARSED,()=>{c.current&&(f.current.onError(null),g(),f.current.onRecoveryEnd())}),h.loadSource(s),i.current=h}else S.canPlayType("application/vnd.apple.mpegurl")&&(S.src=s);return()=>{c.current=!1,o()}}},[s,o,g]);const y=m.useCallback(()=>{f.current.onError(null),i.current?.loadSource(s)},[s]);return{videoRef:l,hlsRef:i,retry:y}}function aa(s){switch(s){case MediaError.MEDIA_ERR_ABORTED:return"unknown_error";case MediaError.MEDIA_ERR_NETWORK:return"network_error";case MediaError.MEDIA_ERR_DECODE:case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:return"media_error";default:return"unknown_error"}}function la(s,t){const e=aa(s.code);return{type:e,message:t(e==="network_error"?"player.error.network":e==="media_error"?"player.error.directPlayFailed":"player.error.unknown"),recoverable:e==="network_error"||e==="media_error"}}function ia({item:s,preferredAudioStreamIndex:t,onError:e,onStrategyChange:r,t:a}){const[l,i]=m.useState("hls"),[u,c]=m.useState(""),[f,g]=m.useState(!0),[o,y]=m.useState(null),S=m.useRef(0),h=m.useRef(null),w=m.useRef(!0),T=m.useRef(null),p=m.useRef(null),E=m.useRef("hls"),d=m.useCallback(_=>{E.current=_,i(_)},[]),j=m.useRef({onError:e,onStrategyChange:r,t:a});j.current={onError:e,onStrategyChange:r,t:a};const x=na({videoUrl:l==="hls"?u:"",onError:_=>{if(_&&w.current){const C={type:_.type==="network"?"network_error":"media_error",message:_.message,recoverable:_.recoverable};y(C),j.current.onError?.(C)}else y(null)},onRecoveryStart:()=>{},onRecoveryEnd:()=>{},t:a}),I=m.useCallback(async()=>{if(!s?.Id||!w.current)return;T.current&&(h.current=ar(T.current)),await zs(s.Id);const _=await tr(s),C=_.strategy==="hls"?_.url:"";w.current&&(d("hls"),c(C||_.url),j.current.onStrategyChange?.("hls"))},[s]),R=m.useCallback(async _=>{if(!w.current||l!=="direct")return;const C=_.target,L=C.error;if(!L)return;const A=la(L,j.current.t);if(A.type==="media_error"){y(A),j.current.onError?.(A),await I();return}if(A.type==="network_error"){if(S.current<1){S.current++,C.load();return}y(A),j.current.onError?.(A),await I();return}y(A),j.current.onError?.(A),await I()},[l,I]);m.useEffect(()=>{if(!s?.Id){g(!1),c("");return}return w.current=!0,g(!0),y(null),S.current=0,(async()=>{try{const C=await tr(s,void 0,t);if(!w.current)return;C.strategy==="hls"&&await zs(s.Id),d(C.strategy),c(C.url),g(!1),j.current.onStrategyChange?.(C.strategy)}catch(C){if(!w.current)return;const L={type:"unknown_error",message:j.current.t("player.error.unknown"),recoverable:!1,originalError:C instanceof Error?C:void 0};y(L),g(!1),j.current.onError?.(L)}})(),()=>{w.current=!1;const C=E.current==="hls"?x.videoRef.current:T.current;En(_n(C))}},[s,t,x.videoRef]),m.useEffect(()=>{if(l!=="direct"||!u)return;const _=T.current;if(_){if(_.addEventListener("error",R),_.src=u,h.current){const C=()=>{h.current&&(lr(_,h.current),h.current=null),_.removeEventListener("canplay",C)};_.addEventListener("canplay",C)}return()=>{_.removeEventListener("error",R)}}},[l,u,R]),m.useEffect(()=>{if(l!=="hls"||!x.videoRef.current||!u)return;const _=x.videoRef.current;if(h.current){const C=()=>{h.current&&(lr(_,h.current),h.current=null),_.removeEventListener("canplay",C)};return _.addEventListener("canplay",C),()=>{_.removeEventListener("canplay",C)}}},[l,x.videoRef,u]);const D=m.useCallback(()=>{y(null),S.current=0,l==="hls"?x.retry():T.current&&T.current.load()},[l,x]),k=m.useCallback(async _=>{const C=E.current==="hls"?x.videoRef.current:T.current;C&&(h.current=ar(C)),E.current==="direct"&&(T.current&&(T.current.pause(),T.current.src=""),s?.Id&&await zs(s.Id),d("hls"),j.current.onStrategyChange?.("hls")),c(_)},[s?.Id,x.videoRef,d]),B=l==="hls"?x.videoRef:T,N=l==="hls"?x.hlsRef:p;return{videoRef:B,hlsRef:N,strategy:l,isLoading:f,error:o,retry:D,videoUrl:u,reloadHlsWithUrl:k}}const oa={srt:"SRT",subrip:"SRT",ass:"ASS",ssa:"SSA",pgs:"PGS",pgssub:"PGS",hdmv_pgs_subtitle:"PGS",vobsub:"VobSub",dvdsub:"DVD",dvd_subtitle:"DVD",webvtt:"WebVTT",vtt:"WebVTT",mov_text:"MOV",text:"Text"},ca={1:"Mono",2:"Stereo",6:"5.1",8:"7.1"},ua="Audio",da="Subtitle";function Tr(s){const t={audioTracks:[],subtitleTracks:[]};if(!s?.MediaSources?.length)return t;const r=s.MediaSources[0].MediaStreams??[],a=[],l=[];let i=0,u=0;for(const c of r)c.Type===ua?(a.push(fa(c,i)),i++):c.Type===da&&(l.push(ma(c,u)),u++);return{audioTracks:a,subtitleTracks:l}}function fa(s,t){const e=s.Language??null,r=s.Codec?.toUpperCase()??"Unknown",a=s.Channels??2;return{index:s.Index??0,relativeIndex:t,language:e,displayTitle:s.DisplayTitle??ga({language:e,codec:r,channels:a}),codec:r,channels:a,isDefault:s.IsDefault??!1}}function ma(s,t){const e=s.Language??null,r=s.Codec?.toLowerCase()??"",a=oa[r]??(r.toUpperCase()||"Unknown");return{index:s.Index??0,relativeIndex:t,language:e,displayTitle:s.DisplayTitle??pa({language:e,format:a}),format:a,isExternal:s.IsExternal??!1,isDefault:s.IsDefault??!1,deliveryUrl:s.DeliveryUrl}}function ga(s){const t=kr(s.language),e=ca[s.channels]??`${s.channels}ch`;return`${t} - ${s.codec} ${e}`}function pa(s){return`${kr(s.language)} - ${s.format}`}const or={eng:"English",en:"English",deu:"German",de:"German",ger:"German",fra:"French",fr:"French",fre:"French",spa:"Spanish",es:"Spanish",ita:"Italian",it:"Italian",jpn:"Japanese",ja:"Japanese",kor:"Korean",ko:"Korean",zho:"Chinese",zh:"Chinese",chi:"Chinese",por:"Portuguese",pt:"Portuguese",rus:"Russian",ru:"Russian",ara:"Arabic",ar:"Arabic",hin:"Hindi",hi:"Hindi",nld:"Dutch",nl:"Dutch",dut:"Dutch",pol:"Polish",pl:"Polish",swe:"Swedish",sv:"Swedish",nor:"Norwegian",no:"Norwegian",dan:"Danish",da:"Danish",fin:"Finnish",fi:"Finnish",tur:"Turkish",tr:"Turkish",tha:"Thai",th:"Thai",vie:"Vietnamese",vi:"Vietnamese",ind:"Indonesian",id:"Indonesian",ces:"Czech",cs:"Czech",cze:"Czech",hun:"Hungarian",hu:"Hungarian",ron:"Romanian",ro:"Romanian",rum:"Romanian",ell:"Greek",el:"Greek",gre:"Greek",heb:"Hebrew",he:"Hebrew",ukr:"Ukrainian",uk:"Ukrainian",und:"Undetermined"};function kr(s){if(!s)return"Unknown";const t=s.toLowerCase();if(or[t])return or[t];try{const r=new Intl.DisplayNames(["en"],{type:"language"}).of(t);if(r&&r!==t)return r}catch{}return"Unknown"}function wr(s){const t=s.format.toLowerCase();return t==="ass"||t==="ssa"}const{TICKS_PER_SECOND:ha}=Rr,{SUPPORTED_FONT_TYPES:ya,JASSUB_READY_TIMEOUT_MS:xa}=Pr;function ba(s,t){const{serverAddress:e,accessToken:r}=Bs();if(s.deliveryUrl){const i=s.deliveryUrl.startsWith("/")?s.deliveryUrl.slice(1):s.deliveryUrl;return Os({serverAddress:e,accessToken:r,endpoint:i})}const a=t.replace(/-/g,""),l=s.format.toLowerCase()==="ssa"?"ssa":"ass";return Os({serverAddress:e,accessToken:r,endpoint:`Videos/${t}/${a}/Subtitles/${s.index}/Stream.${l}`})}function va(s){const{serverAddress:t}=Bs(),e=s.MediaSources?.[0];if(!e?.MediaAttachments?.length)return[];const r=s.Id??"",a=e.Id??r.replace(/-/g,""),l=t.replace(/\/+$/,"");return e.MediaAttachments.filter(i=>{const u=i.MimeType?.toLowerCase();return u&&ya.some(c=>c.toLowerCase()===u)}).flatMap(i=>i.DeliveryUrl?[`${l}${i.DeliveryUrl}`]:i.Index!=null?[`${l}/Videos/${r}/${a}/Attachments/${i.Index}`]:[])}function cr(s,t){return s/ha+t}async function Sa(s){const{video:t,track:e,item:r,transcodingOffsetTicks:a=0,userOffset:l=0}=s,i=r.Id??"",u=ba(e,i),c=va(r),f=cr(a,l),g=(await Ir(async()=>{const{default:S}=await import("./jassub-BtnWmffD.js");return{default:S}},__vite__mapDeps([0,1]))).default,o=new g({video:t,subUrl:u,fonts:c,timeOffset:f,useLocalFonts:!0,debug:!1});await Promise.race([o.ready,new Promise((S,h)=>setTimeout(()=>h(new Error("JASSUB ready timeout")),xa))]).catch(S=>{throw o.destroy(),S});let y=!1;return{instance:o,destroy:()=>{if(!y){y=!0;try{o.destroy()}catch{}}},setTimeOffset:(S,h)=>{if(!y)try{o.timeOffset=cr(S,h)}catch{}},setTrack:async S=>{if(y)return;const h=await fetch(S);if(!h.ok)throw new Error(`Failed to fetch subtitle: ${h.status}`);const w=await h.text();await o.renderer.setTrack(w)}}}function Ta(s,t,e="vtt"){const r=Bs();if(!r.serverAddress||!r.accessToken)return"";const a=new URLSearchParams({DeviceId:Ar()});return Os({serverAddress:r.serverAddress,accessToken:r.accessToken,endpoint:`Videos/${s}/${s}/Subtitles/${t}/0/Stream.${e}`,query:a})}function Er(s,t){return jn({itemId:s},t)}function _r(s,t){return t.find(r=>r.index===s)?.relativeIndex??-1}function ka(s,t,e){if(!t)return{success:!1,error:{type:"api_unsupported",message:"HLS instance not available",trackIndex:s}};if(e&&e.length>0&&!e.find(l=>l.index===s))return{success:!1,error:{type:"track_unavailable",message:`Audio track with MediaStream index ${s} not found in track list`,trackIndex:s}};const r=t.audioTracks;if(r.length>1){let a=-1;if(e&&e.length>0){const l=e.find(i=>i.index===s);if(l?.language){const i=l.language.toLowerCase(),u=r.findIndex(c=>c.lang?.toLowerCase()===i||c.name&&c.name.toLowerCase().includes(i));u!==-1&&(a=u)}if(a===-1){const i=e.findIndex(u=>u.index===s);i!==-1&&i<r.length&&(a=i)}}if(a>=0&&a<r.length)try{return t.audioTrack=a,{success:!0}}catch{}}return{success:!0,reloadRequired:!0}}function wa(s,t){const{videoElement:e,audioTracks:r,itemId:a,onReloadHls:l}=t,u=e.audioTracks,c=r?.find(g=>g.index===s);if(!c)return Promise.resolve({success:!1,error:{type:"track_unavailable",message:`Audio track with index ${s} not found`,trackIndex:s}});if(u&&u.length>1){if(c.relativeIndex>=0&&c.relativeIndex<u.length){for(let o=0;o<u.length;o++)u[o].enabled=o===c.relativeIndex;return Promise.resolve({success:!0})}if(c.language){const o=c.language.toLowerCase();for(let y=0;y<u.length;y++){const h=u[y].language.toLowerCase();if(h===o||h.startsWith(o.slice(0,2))||o.startsWith(h.slice(0,2))){for(let w=0;w<u.length;w++)u[w].enabled=w===y;return Promise.resolve({success:!0})}}}const g=r?.findIndex(o=>o.index===s)??-1;if(g>=0&&g<u.length){for(let o=0;o<u.length;o++)u[o].enabled=o===g;return Promise.resolve({success:!0})}}if(!a)return Promise.resolve({success:!1,error:{type:"api_unsupported",message:"Audio track switching requires transcoding in this browser. Item ID not available.",trackIndex:s}});if(!l)return Promise.resolve({success:!1,error:{type:"api_unsupported",message:"Audio track switching requires transcoding in this browser. Please wait for the stream to reload.",trackIndex:s}});const f=Er(a,s);return f?(l(f),Promise.resolve({success:!0,reloadRequired:!0})):Promise.resolve({success:!1,error:{type:"network_error",message:"Failed to generate HLS URL for audio track switching",trackIndex:s}})}function Ea(s,t,e){if(!t)return{success:!1,error:{type:"api_unsupported",message:"HLS instance not available",trackIndex:s??-1}};try{if(s===null)return t.subtitleTrack=-1,{success:!0};let r;if(e&&e.length>0){if(r=_r(s,e),r===-1)return{success:!1,error:{type:"track_unavailable",message:`Subtitle track with MediaStream index ${s} not found in track list`,trackIndex:s}}}else r=s;const a=t.subtitleTracks;return r<0||r>=a.length?{success:!1,error:{type:"track_unavailable",message:`Subtitle track relative index ${r} is out of range (0-${a.length-1})`,trackIndex:s}}:(t.subtitleTrack=r,{success:!0})}catch(r){return{success:!1,error:{type:"unknown_error",message:r instanceof Error?r.message:"Failed to switch subtitle track",trackIndex:s??-1}}}}async function _a(s,t){const{videoElement:e,itemId:r,subtitleTracks:a}=t,l=e.textTracks;if(s===null)return Array.from(l).forEach(u=>{u.mode="hidden"}),{success:!0};let i;if(a&&a.length>0?i=_r(s,a):i=s,i!==-1&&i>=0&&i<l.length)return Array.from(l).forEach(u=>{u.mode="hidden"}),l[i].mode="showing",{success:!0};if(!r)return{success:!1,error:{type:"track_unavailable",message:"Subtitle track not available and no item ID for external fetch",trackIndex:s}};try{const u=Ta(r,s,"vtt");if(!u)return{success:!1,error:{type:"network_error",message:"Failed to generate subtitle URL",trackIndex:s}};const c=document.createElement("track");c.kind="subtitles",c.src=u,c.default=!0,Array.from(l).forEach(g=>{g.mode="hidden"}),e.appendChild(c),await new Promise((g,o)=>{c.addEventListener("load",()=>g()),c.addEventListener("error",()=>o(new Error("Failed to load subtitle"))),setTimeout(()=>o(new Error("Subtitle load timeout")),1e4)});const f=l.length-1;return f>=0&&(l[f].mode="showing"),{success:!0}}catch(u){return{success:!1,error:{type:"network_error",message:u instanceof Error?u.message:"Failed to load external subtitle",trackIndex:s}}}}async function ja(s,t){if(t.strategy==="hls"){const e=ka(s,t.hlsInstance,t.audioTracks);if(e.success&&e.reloadRequired){if(!t.itemId)return{success:!1,error:{type:"api_unsupported",message:"Item ID required for HLS audio track switching",trackIndex:s}};if(!t.onReloadHls)return{success:!1,error:{type:"api_unsupported",message:"HLS reload callback not provided",trackIndex:s}};const r=Er(t.itemId,s);return r?(t.onReloadHls(r),{success:!0,reloadRequired:!0}):{success:!1,error:{type:"network_error",message:"Failed to generate HLS URL with audio track",trackIndex:s}}}return e}return wa(s,t)}async function Ca(s,t){if(s===null){const r=t.videoElement.textTracks;return Array.from(r).forEach(a=>{a.mode="hidden"}),t.strategy==="hls"&&t.hlsInstance&&(t.hlsInstance.subtitleTrack=-1),{success:!0,jassubAction:"dispose"}}const e=t.subtitleTracks?.find(r=>r.index===s);if(!e)return{success:!1,error:{type:"track_unavailable",message:`Subtitle track with index ${s} not found`,trackIndex:s}};if(wr(e)){const r=t.videoElement.textTracks;return Array.from(r).forEach(a=>{a.mode="hidden"}),t.strategy==="hls"&&t.hlsInstance&&(t.hlsInstance.subtitleTrack=-1),{success:!0,jassubAction:"initialize",track:e}}return t.strategy==="hls"?Ea(s,t.hlsInstance,t.subtitleTracks):_a(s,t)}const ur={audioTracks:[],subtitleTracks:[],activeAudioIndex:0,activeSubtitleIndex:null};function Na(s,t){if(t){const r=s.find(a=>Ws(a.language,t));if(r)return r.index}const e=s.find(r=>r.isDefault);return e?e.index:s.length>0?s[0].index:0}function Ia(s,t,e){if(!e)return null;if(t){const a=s.find(l=>Ws(l.language,t));if(a)return a.index}const r=s.find(a=>a.isDefault);return r?r.index:null}function Pa({item:s,strategy:t,videoRef:e,hlsRef:r,t:a,onReloadHls:l}){const[i,u]=m.useState(ur),[c,f]=m.useState(!1),[g,o]=m.useState(null),y=gs(T=>T.trackPreferences);m.useEffect(()=>{if(!s){u(ur),o(null);return}const{audioTracks:T,subtitleTracks:p}=Tr(s),E=Na(T,y.preferredAudioLanguage),d=Ia(p,y.preferredSubtitleLanguage,y.subtitlesEnabled);u({audioTracks:T,subtitleTracks:p,activeAudioIndex:E,activeSubtitleIndex:d}),o(null)},[s,y]);const S=m.useMemo(()=>({strategy:t,videoElement:e.current,hlsInstance:r?.current,itemId:s?.Id,mediaSourceId:s?.MediaSources?.[0]?.Id??void 0,audioTracks:i.audioTracks,subtitleTracks:i.subtitleTracks,onReloadHls:l}),[t,e,r,s?.Id,s?.MediaSources,i.audioTracks,i.subtitleTracks,l]),h=m.useCallback(async T=>{const p=e.current;if(!p){o(a("player.tracks.error.noVideo"));return}if(!i.audioTracks.find(d=>d.index===T)){const d=a("player.tracks.error.trackNotFound");o(d),Ct(d);return}if(T!==i.activeAudioIndex){f(!0),o(null);try{const d=await ja(T,{...S,videoElement:p,hlsInstance:r?.current});if(d.success)u(j=>({...j,activeAudioIndex:T}));else if(d.error){const j=d.error.message||a("player.tracks.error.switchFailed");o(j),Ct(j)}}catch(d){const j=d instanceof Error?d.message:a("player.tracks.error.switchFailed");o(j),Ct(j)}finally{f(!1)}}},[e,r,i.audioTracks,i.activeAudioIndex,S,a]),w=m.useCallback(async T=>{const p=e.current;if(!p){o(a("player.tracks.error.noVideo"));return}if(T!==null&&!i.subtitleTracks.find(d=>d.index===T)){const d=a("player.tracks.error.trackNotFound");o(d),Ct(d);return}if(T!==i.activeSubtitleIndex){f(!0),o(null);try{const E=await Ca(T,{...S,videoElement:p,hlsInstance:r?.current});if(E.success)u(d=>({...d,activeSubtitleIndex:T}));else if(E.error){const d=E.error.message||a("player.tracks.error.switchFailed");o(d),Ct(d)}}catch(E){const d=E instanceof Error?E.message:a("player.tracks.error.switchFailed");o(d),Ct(d)}finally{f(!1)}}},[e,r,i.subtitleTracks,i.activeSubtitleIndex,S,a]);return{trackState:i,selectAudioTrack:h,selectSubtitleTrack:w,isLoading:c,error:g}}const Ra=15e3;function Aa(s){return s.readyState>=1&&s.videoWidth>0?Promise.resolve():new Promise((t,e)=>{const r=setTimeout(()=>{a(),e(new Error("Timeout waiting for video metadata"))},Ra),a=()=>{clearTimeout(r),s.removeEventListener("loadedmetadata",l),s.removeEventListener("error",i)},l=()=>{a(),t()},i=()=>{a(),e(new Error("Video error"))};s.addEventListener("loadedmetadata",l),s.addEventListener("error",i)})}function Da(s,t){const e=s instanceof Error?s.message.toLowerCase():"";return e.includes("timeout")?t("player.subtitle.error.timeout"):e.includes("wasm")||e.includes("worker")?t("player.subtitle.error.wasmFailed"):e.includes("fetch")||e.includes("network")?t("player.subtitle.error.loadFailed"):t("player.subtitle.error.jassubInit")}function Ma({videoRef:s,activeTrack:t,item:e,transcodingOffsetTicks:r,userOffset:a,t:l}){const[i,u]=m.useState(!1),[c,f]=m.useState(!1),[g,o]=m.useState(null),y=m.useRef(null),S=m.useRef(a),h=m.useRef(r),w=m.useRef(null);S.current=a,h.current=r;const T=m.useCallback(()=>{y.current?.destroy(),y.current=null,u(!1)},[]),p=m.useCallback(()=>{w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{y.current?.instance.resize()},ys.RESIZE_DEBOUNCE_MS)},[]),E=m.useCallback(d=>{S.current=d,y.current?.setTimeOffset(h.current,d)},[]);return m.useEffect(()=>{const d=s.current;if(!(t&&wr(t))||!d||!e?.Id){T(),o(null);return}let x=!1;return(async()=>{T(),f(!0),o(null);try{if(await Aa(d),x)return;const R=await Sa({video:d,track:t,item:e,transcodingOffsetTicks:r,userOffset:S.current});y.current=R,u(!0)}catch(R){if(x)return;const D=R instanceof Error?R.message:String(R);o(D),Ct(Da(R,l),D),console.error("[JASSUB] Init error:",R)}finally{x||f(!1)}})(),()=>{x=!0}},[t,e,s,r,T,l]),m.useEffect(()=>{const d=s.current;if(!d||!i)return;const j=new ResizeObserver(p);j.observe(d);const x=()=>setTimeout(p,150);return document.addEventListener("fullscreenchange",x),()=>{j.disconnect(),document.removeEventListener("fullscreenchange",x),w.current&&clearTimeout(w.current)}},[s,i,p]),m.useEffect(()=>()=>{T(),w.current&&clearTimeout(w.current)},[T]),{isActive:i,isLoading:c,error:g,setUserOffset:E,resize:p}}const dr={" ":"togglePlay",w:"cycleSkipTimeUp",s:"cycleSkipTimeDown",a:"skipBackward",d:"skipForward",e:"pushStartTimestamp",f:"pushEndTimestamp",m:"toggleMute"};function La(s){const t=m.useMemo(()=>Object.values(s),[s.togglePlay,s.cycleSkipTimeUp,s.cycleSkipTimeDown,s.skipBackward,s.skipForward,s.pushStartTimestamp,s.pushEndTimestamp,s.toggleMute]);m.useEffect(()=>{const e=new AbortController,r=a=>{if(Fn(a.target))return;const l=a.key.toLowerCase();l in dr&&(a.preventDefault(),s[dr[l]]())};return window.addEventListener("keydown",r,{signal:e.signal}),()=>e.abort()},[t,s])}const{SKIP_TIMES:fr}=ys,Fa=s=>({vibrantColors:s.vibrantColors,persistedVolume:s.playerVolume,persistedMuted:s.playerMuted,setPlayerVolume:s.setPlayerVolume,setPlayerMuted:s.setPlayerMuted});function $a(s,t){if(!t)return;const{audioTracks:e}=Tr(s);return e.length===0?void 0:e.find(a=>Ws(a.language,t))?.index}function za(s){const t=He.c(162),{item:e,timestamp:r,onCreateSegment:a,onUpdateSegmentTimestamp:l,className:i}=s,{t:u}=ps(),{vibrantColors:c,persistedVolume:f,persistedMuted:g,setPlayerVolume:o,setPlayerMuted:y}=Lt(Dr(Fa)),{getButtonStyle:S,iconColor:h,hasColors:w}=Sr(c);let T;t[0]!==g||t[1]!==f?(T={...Zn,volume:f,isMuted:g},t[0]=g,t[1]=f,t[2]=T):T=t[2];const[p,E]=m.useReducer(ea,T),{isPlaying:d,currentTime:j,duration:x,buffered:I,volume:R,isMuted:D,skipTimeIndex:k,playerError:B,isRecovering:N,subtitleOffset:_}=p,C=m.useRef(j),L=m.useRef(x),A=m.useRef(null),W=m.useRef(null),[U,re]=m.useState(!1);let Y,K;t[3]!==j||t[4]!==x?(Y=()=>{C.current=j,L.current=x},K=[j,x],t[3]=j,t[4]=x,t[5]=Y,t[6]=K):(Y=t[5],K=t[6]),m.useLayoutEffect(Y,K);let M;t[7]!==e?(M=vr(e,900,506)??null,t[7]=e,t[8]=M):M=t[8];const X=Cn(M),ae=Ba;let G;t[9]===Symbol.for("react.memo_cache_sentinel")?(G=v=>{if(v){const me={type:ae(v.type),message:v.message,recoverable:v.recoverable};E({type:"ERROR_STATE",error:me,isRecovering:!1})}else E({type:"ERROR_STATE",error:null,isRecovering:!1})},t[9]=G):G=t[9];const Te=G;let z;t[10]!==u?(z=v=>{A.current==="direct"&&v==="hls"&&$t({type:"info",message:u("player.notification.switchedToTranscode"),duration:3e3}),A.current=v},t[10]=u,t[11]=z):z=t[11];const Z=z,ke=gs(Ha);let le;t[12]!==e||t[13]!==ke?(le=$a(e,ke),t[12]=e,t[13]=ke,t[14]=le):le=t[14];const ge=le;let be;t[15]!==Z||t[16]!==e||t[17]!==ge||t[18]!==u?(be={item:e,preferredAudioStreamIndex:ge,onError:Te,onStrategyChange:Z,t:u},t[15]=Z,t[16]=e,t[17]=ge,t[18]=u,t[19]=be):be=t[19];const{videoRef:b,hlsRef:je,strategy:ee,isLoading:Re,error:ce,retry:Ce,reloadHlsWithUrl:pe}=ia(be),ye=gs(Va),we=gs(Oa),Ee=gs(Ua);let ue;t[20]!==je||t[21]!==e||t[22]!==pe||t[23]!==ee||t[24]!==u||t[25]!==b?(ue={item:e,strategy:ee,videoRef:b,hlsRef:je,t:u,onReloadHls:pe},t[20]=je,t[21]=e,t[22]=pe,t[23]=ee,t[24]=u,t[25]=b,t[26]=ue):ue=t[26];const{trackState:F,selectAudioTrack:Ae,selectSubtitleTrack:De,isLoading:ve}=Pa(ue);let Me;e:{if(F.activeSubtitleIndex===null){Me=null;break e}let v;t[27]!==F.activeSubtitleIndex||t[28]!==F.subtitleTracks?(v=F.subtitleTracks.find(me=>me.index===F.activeSubtitleIndex)??null,t[27]=F.activeSubtitleIndex,t[28]=F.subtitleTracks,t[29]=v):v=t[29],Me=v}const ie=Me;let q;t[30]!==ie||t[31]!==e||t[32]!==_||t[33]!==u||t[34]!==b?(q={videoRef:b,activeTrack:ie,item:e,transcodingOffsetTicks:0,userOffset:_,t:u},t[30]=ie,t[31]=e,t[32]=_,t[33]=u,t[34]=b,t[35]=q):q=t[35],Ma(q);let se,oe;t[36]!==ce?(se=()=>{ce&&E({type:"ERROR_STATE",error:{type:ae(ce.type),message:ce.message,recoverable:ce.recoverable},isRecovering:!1})},oe=[ce,ae],t[36]=ce,t[37]=se,t[38]=oe):(se=t[37],oe=t[38]),m.useEffect(se,oe);let de,xe;t[39]!==r||t[40]!==b?(de=()=>{r!==void 0&&b.current&&(b.current.currentTime=r)},xe=[r,b],t[39]=r,t[40]=b,t[41]=de,t[42]=xe):(de=t[41],xe=t[42]),m.useEffect(de,xe);let fe,$;t[43]!==g||t[44]!==f||t[45]!==b?(fe=()=>{const v=b.current;v&&(v.volume=f,v.muted=g)},$=[b,f,g],t[43]=g,t[44]=f,t[45]=b,t[46]=fe,t[47]=$):(fe=t[46],$=t[47]),m.useEffect(fe,$);let J;t[48]!==b?(J=()=>{b.current&&E({type:"PLAYBACK_UPDATE",currentTime:b.current.currentTime})},t[48]=b,t[49]=J):J=t[49];const V=J;let Se;t[50]!==b?(Se=()=>{b.current&&E({type:"MEDIA_LOADED",duration:b.current.duration})},t[50]=b,t[51]=Se):Se=t[51];const ze=Se;let Ne;t[52]!==b?(Ne=()=>{const v=b.current;v?.buffered.length&&E({type:"BUFFER_UPDATE",buffered:v.buffered.end(v.buffered.length-1)})},t[52]=b,t[53]=Ne):Ne=t[53];const Be=Ne;let Le;t[54]===Symbol.for("react.memo_cache_sentinel")?(Le=()=>{E({type:"PLAY_STATE",isPlaying:!0})},t[54]=Le):Le=t[54];const We=Le;let Fe;t[55]===Symbol.for("react.memo_cache_sentinel")?(Fe=()=>{E({type:"PLAY_STATE",isPlaying:!1})},t[55]=Fe):Fe=t[55];const Ke=Fe;let Ie;t[56]!==b?(Ie=()=>{const v=b.current;v&&(v.paused?v.play():v.pause())},t[56]=b,t[57]=Ie):Ie=t[57];const he=Ie;let Pe;t[58]!==y||t[59]!==p.volume||t[60]!==b?(Pe=()=>{const v=b.current;v&&(v.muted=!v.muted,E({type:"VOLUME_CHANGE",volume:p.volume,isMuted:v.muted}),y(v.muted))},t[58]=y,t[59]=p.volume,t[60]=b,t[61]=Pe):Pe=t[61];const _e=Pe;let Ve;t[62]!==y||t[63]!==o||t[64]!==b?(Ve=v=>{const me=b.current;if(!me)return;me.volume=v;const at=v>0&&me.muted,_t=v===0?!0:at?!1:me.muted;at&&(me.muted=!1),E({type:"VOLUME_CHANGE",volume:v,isMuted:_t}),o(v),y(_t)},t[62]=y,t[63]=o,t[64]=b,t[65]=Ve):Ve=t[65];const $e=Ve;let P;t[66]!==b?(P=v=>{b.current&&(b.current.currentTime=v,E({type:"PLAYBACK_UPDATE",currentTime:v}))},t[66]=b,t[67]=P):P=t[67];const H=P;let te;t[68]!==k||t[69]!==b?(te=()=>{const v=b.current;if(!v)return;const me=Math.min(C.current+fr[k],L.current);v.currentTime=me,E({type:"PLAYBACK_UPDATE",currentTime:me})},t[68]=k,t[69]=b,t[70]=te):te=t[70];const O=te;let Ge;t[71]!==k||t[72]!==b?(Ge=()=>{const v=b.current;if(!v)return;const me=Math.max(C.current-fr[k],0);v.currentTime=me,E({type:"PLAYBACK_UPDATE",currentTime:me})},t[71]=k,t[72]=b,t[73]=Ge):Ge=t[73];const Je=Ge;let Ue;t[74]===Symbol.for("react.memo_cache_sentinel")?(Ue=()=>{E({type:"CYCLE_SKIP",direction:1})},t[74]=Ue):Ue=t[74];const lt=Ue;let it;t[75]===Symbol.for("react.memo_cache_sentinel")?(it=()=>{E({type:"CYCLE_SKIP",direction:-1})},t[75]=it):it=t[75];const Nt=it;let ot;t[76]!==l?(ot=()=>{l({currentTime:C.current,start:!0})},t[76]=l,t[77]=ot):ot=t[77];const Xe=ot;let ct;t[78]!==l?(ct=()=>{l({currentTime:C.current,start:!1})},t[78]=l,t[79]=ct):ct=t[79];const Ze=ct;let ut;t[80]!==a?(ut=v=>{a({type:v,start:C.current})},t[80]=a,t[81]=ut):ut=t[81];const It=ut;let dt;t[82]!==Ze||t[83]!==Xe||t[84]!==Je||t[85]!==O||t[86]!==_e||t[87]!==he?(dt={togglePlay:he,cycleSkipTimeUp:lt,cycleSkipTimeDown:Nt,skipBackward:Je,skipForward:O,pushStartTimestamp:Xe,pushEndTimestamp:Ze,toggleMute:_e},t[82]=Ze,t[83]=Xe,t[84]=Je,t[85]=O,t[86]=_e,t[87]=he,t[88]=dt):dt=t[88],La(dt);let ft;t[89]===Symbol.for("react.memo_cache_sentinel")?(ft=()=>{const v=W.current;v&&(document.fullscreenElement?document.exitFullscreen():v.requestFullscreen())},t[89]=ft):ft=t[89];const Pt=ft;let wt,mt;t[90]===Symbol.for("react.memo_cache_sentinel")?(wt=()=>{const v=()=>{re(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",v),()=>{document.removeEventListener("fullscreenchange",v)}},mt=[],t[90]=wt,t[91]=mt):(wt=t[90],mt=t[91]),m.useEffect(wt,mt);let Rt;t[92]===Symbol.for("react.memo_cache_sentinel")?(Rt=v=>{E({type:"SKIP_TIME_CHANGE",skipTimeIndex:v})},t[92]=Rt):Rt=t[92];const hs=Rt;let gt;t[93]!==Ae||t[94]!==ye||t[95]!==F.audioTracks?(gt=async v=>{await Ae(v);const me=F.audioTracks.find(at=>at.index===v);me?.language&&ye(me.language)},t[93]=Ae,t[94]=ye,t[95]=F.audioTracks,t[96]=gt):gt=t[96];const bt=gt;let pt;t[97]!==De||t[98]!==we||t[99]!==Ee||t[100]!==F.subtitleTracks?(pt=async v=>{if(await De(v),v===null)Ee(!1);else{Ee(!0);const me=F.subtitleTracks.find(at=>at.index===v);me?.language&&we(me.language)}},t[97]=De,t[98]=we,t[99]=Ee,t[100]=F.subtitleTracks,t[101]=pt):pt=t[101];const At=pt,Dt=F.audioTracks.length>0||F.subtitleTracks.length>0;let vt;t[102]!==i?(vt=Q("flex flex-col gap-4",i),t[102]=i,t[103]=vt):vt=t[103];let et;t[104]!==u?(et=u("player.videoPlayer"),t[104]=u,t[105]=et):et=t[105];let tt;t[106]!==ze||t[107]!==Be||t[108]!==V||t[109]!==X||t[110]!==et||t[111]!==b?(tt=n.jsx("video",{ref:b,className:"w-full h-full object-contain",poster:X,crossOrigin:"anonymous",playsInline:!0,"aria-label":et,onTimeUpdate:V,onDurationChange:ze,onProgress:Be,onPlay:We,onPause:Ke}),t[106]=ze,t[107]=Be,t[108]=V,t[109]=X,t[110]=et,t[111]=b,t[112]=tt):tt=t[112];let ht;t[113]!==Ce||t[114]!==N||t[115]!==B||t[116]!==ee||t[117]!==u?(ht=B&&!N&&n.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/80 text-white",children:[n.jsx(gn,{className:"size-12 text-destructive mb-4"}),n.jsx("p",{className:"text-lg font-medium mb-2",children:B.message}),ee==="direct"&&B.type==="media"&&n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:u("player.error.directPlayFailed")}),B.recoverable&&n.jsxs(Oe,{variant:"outline",size:"sm",onClick:v=>{v.stopPropagation(),Ce()},className:"mt-2",children:[n.jsx($s,{className:"size-4 mr-2"}),u("player.retry")]})]}),t[113]=Ce,t[114]=N,t[115]=B,t[116]=ee,t[117]=u,t[118]=ht):ht=t[118];let st;t[119]!==Re||t[120]!==u?(st=Re&&n.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",role:"status","aria-live":"polite","aria-busy":"true",children:[n.jsx($s,{className:"size-8 text-white animate-spin","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:u("accessibility.loading")})]}),t[119]=Re,t[120]=u,t[121]=st):st=t[121];let yt;t[122]!==N||t[123]!==u?(yt=N&&n.jsxs("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60",role:"status","aria-live":"polite","aria-busy":"true",children:[n.jsx($s,{className:"size-8 text-white animate-spin","aria-hidden":"true"}),n.jsx("span",{className:"sr-only",children:u("player.recovering","Recovering playback")})]}),t[122]=N,t[123]=u,t[124]=yt):yt=t[124];let rt;t[125]!==tt||t[126]!==ht||t[127]!==st||t[128]!==yt||t[129]!==he?(rt=n.jsx("div",{ref:W,className:"relative",children:n.jsxs("div",{className:"relative cursor-pointer aspect-video",onClick:he,children:[tt,ht,st,yt]})}),t[125]=tt,t[126]=ht,t[127]=st,t[128]=yt,t[129]=he,t[130]=rt):rt=t[130];let St;t[131]!==I||t[132]!==j||t[133]!==x||t[134]!==H?(St=n.jsx(On,{currentTime:j,duration:x,buffered:I,onSeek:H}),t[131]=I,t[132]=j,t[133]=x,t[134]=H,t[135]=St):St=t[135];const Tt=!Dt||ve;let nt;t[136]!==S||t[137]!==bt||t[138]!==It||t[139]!==At||t[140]!==$e||t[141]!==w||t[142]!==h||t[143]!==U||t[144]!==D||t[145]!==d||t[146]!==Ze||t[147]!==Xe||t[148]!==k||t[149]!==ee||t[150]!==Tt||t[151]!==_e||t[152]!==he||t[153]!==F||t[154]!==c||t[155]!==R?(nt=n.jsx(Yn,{isPlaying:d,isMuted:D,volume:R,skipTimeIndex:k,vibrantColors:c,hasColors:w,iconColor:h,getButtonStyle:S,onTogglePlay:he,onToggleMute:_e,onVolumeChange:$e,onCreateSegment:It,onPushStartTimestamp:Xe,onPushEndTimestamp:Ze,onSkipTimeChange:hs,trackState:F,onSelectAudioTrack:bt,onSelectSubtitleTrack:At,isTrackSelectorDisabled:Tt,strategy:ee,isFullscreen:U,onToggleFullscreen:Pt}),t[136]=S,t[137]=bt,t[138]=It,t[139]=At,t[140]=$e,t[141]=w,t[142]=h,t[143]=U,t[144]=D,t[145]=d,t[146]=Ze,t[147]=Xe,t[148]=k,t[149]=ee,t[150]=Tt,t[151]=_e,t[152]=he,t[153]=F,t[154]=c,t[155]=R,t[156]=nt):nt=t[156];let Et;return t[157]!==vt||t[158]!==rt||t[159]!==St||t[160]!==nt?(Et=n.jsxs("div",{className:vt,children:[rt,St,nt]}),t[157]=vt,t[158]=rt,t[159]=St,t[160]=nt,t[161]=Et):Et=t[161],Et}function Ua(s){return s.setSubtitlesEnabled}function Oa(s){return s.setPreferredSubtitleLanguage}function Va(s){return s.setPreferredAudioLanguage}function Ha(s){return s.trackPreferences.preferredAudioLanguage}function Ba(s){switch(s){case"media_error":return"media";case"network_error":return"network";default:return"unknown"}}const Ka=s=>t=>{if(Lr(t))return;const e=pr.from(t);Fr(e,{operation:s}),Ct(`${s} failed`,e.recoverable?"Please try again":e.message)},Ga=()=>{const s=He.c(1),t=m.useRef(null);let e;return s[0]===Symbol.for("react.memo_cache_sentinel")?(e=()=>(t.current?.abort(),t.current=new AbortController,t.current),s[0]=e):e=s[0],e},Wa=(s,t)=>async e=>{try{return await s(e,t().signal)}catch(r){throw pr.from(r)}},Ya=(s,t,e,r)=>{if(!e)return;s.setQueryData(zt.list(t),e);const a=s.getQueryData(zt.list(t));(!a||a.length!==e.length||!e.every(l=>a.some(i=>i.Id===l.Id)))&&s.invalidateQueries({queryKey:zt.list(t)}),r.rolledBack=!0},qa=()=>{const s=He.c(12),t=Cr(),e=Ga();let r;s[0]!==e?(r=Wa(Ja,e),s[0]=e,s[1]=r):r=s[1];let a,l;s[2]!==t?(a=async c=>{const{itemId:f,newSegments:g}=c;await t.cancelQueries({queryKey:zt.list(f)});const o=t.getQueryData(zt.list(f));return t.setQueryData(zt.list(f),g),{previousSegments:o,rolledBack:!1}},l=(c,f,g)=>{const{itemId:o}=f;g?.previousSegments&&Ya(t,o,g.previousSegments,g),Ka("Save segments")(c)},s[2]=t,s[3]=a,s[4]=l):(a=s[3],l=s[4]);let i;s[5]!==t?(i=(c,f,g,o)=>{const{itemId:y}=g;o?.rolledBack||t.invalidateQueries({queryKey:zt.list(y)})},s[5]=t,s[6]=i):i=s[6];let u;return s[7]!==r||s[8]!==a||s[9]!==l||s[10]!==i?(u={mutationFn:r,onMutate:a,onError:l,onSuccess:Qa,onSettled:i},s[7]=r,s[8]=a,s[9]=l,s[10]=i,s[11]=u):u=s[11],Nr(u)};function Ja(s,t){const{itemId:e,existingSegments:r,newSegments:a,providerId:l}=s;return $r(e,r,a,l,{signal:t})}function Qa(s,t){const{newSegments:e}=t,r=s.length,a=e.length;r===a?Mr("All segments saved"):r>0&&Ct("Partial save",`${r} of ${a} segments saved`)}const{MIN_SEGMENT_GAP:Mt}=mr,Us=14,Xa=s=>s.saveToClipboard,Za=s=>s.vibrantColors,el=m.memo(function(t){const e=He.c(275),{segment:r,index:a,activeIndex:l,runtimeSeconds:i,onUpdate:u,onDelete:c,onPlayerTimestamp:f,onSetActive:g}=t,{t:o}=ps(),y=Lt(Xa),S=Lt(Za),h=m.useRef(null),[w,T]=m.useState(null),[p,E]=m.useState(r.StartTicks??0),[d,j]=m.useState(r.EndTicks??0),x=m.useRef(p),I=m.useRef(d),R=m.useRef(w),D=m.useRef(null),k=m.useRef(null);let B,N;e[0]!==w||e[1]!==d||e[2]!==p?(B=()=>{x.current=p,I.current=d,R.current=w},N=[p,d,w],e[0]=w,e[1]=d,e[2]=p,e[3]=B,e[4]=N):(B=e[3],N=e[4]),m.useLayoutEffect(B,N);let _,C;e[5]===Symbol.for("react.memo_cache_sentinel")?(_=()=>()=>{D.current!==null&&cancelAnimationFrame(D.current)},C=[],e[5]=_,e[6]=C):(_=e[5],C=e[6]),m.useEffect(_,C);const L=a===l,A=Vs(r.Type);let W;e[7]!==r.Type?(W=zr(r.Type),e[7]=r.Type,e[8]=W):W=e[8];const U=W;let re,Y;e[9]!==r.EndTicks||e[10]!==r.StartTicks?(re=()=>{E(r.StartTicks??0),j(r.EndTicks??0)},Y=[r.StartTicks,r.EndTicks],e[9]=r.EndTicks,e[10]=r.StartTicks,e[11]=re,e[12]=Y):(re=e[11],Y=e[12]),m.useEffect(re,Y);let K;e[13]!==d||e[14]!==p||e[15]!==r?(K=Ks({...r,StartTicks:p,EndTicks:d}),e[13]=d,e[14]=p,e[15]=r,e[16]=K):K=e[16];const M=K,ne=i>0?p/i*100:0,X=i>0?d/i*100:100,ae=X-ne;let G;e[17]!==X||e[18]!==ne||e[19]!==ae?(G={startPercent:ne,endPercent:X,widthPercent:ae},e[17]=X,e[18]=ne,e[19]=ae,e[20]=G):G=e[20];const Te=G,{startPercent:z,endPercent:Z,widthPercent:ke}=Te,le=d-p;let ge;e[21]!==a||e[22]!==g?(ge=Ye=>qe=>{qe.preventDefault(),qe.stopPropagation(),T(Ye),g(a),qe.target.setPointerCapture(qe.pointerId)},e[21]=a,e[22]=g,e[23]=ge):ge=e[23];const be=ge;let b;e[24]!==i?(b=Ye=>{if(!R.current||!h.current)return;const xt=h.current.getBoundingClientRect(),jr=Math.max(0,Math.min(100,(Ye.clientX-xt.left)/xt.width*100))/100*i;k.current=jr,D.current===null&&(D.current=requestAnimationFrame(()=>{D.current=null;const Ms=k.current;if(Ms===null)return;const Ys=R.current;Ys==="start"?E(Math.max(0,Math.min(Ms,I.current-Mt))):Ys==="end"&&j(Math.min(i,Math.max(Ms,x.current+Mt)))}))},e[24]=i,e[25]=b):b=e[25];const je=b;let ee;e[26]!==u||e[27]!==i||e[28]!==r.Id?(ee=Ye=>{if(!R.current)return;D.current!==null&&(cancelAnimationFrame(D.current),D.current=null);const qe=k.current;if(qe!==null){if(R.current==="start"){const ds=Math.max(0,Math.min(qe,I.current-Mt));x.current=ds,E(ds)}else{const ds=Math.min(i,Math.max(qe,x.current+Mt));I.current=ds,j(ds)}k.current=null}Ye.target.releasePointerCapture(Ye.pointerId),T(null),r.Id&&u({id:r.Id,start:x.current,end:I.current})},e[26]=u,e[27]=i,e[28]=r.Id,e[29]=ee):ee=e[29];const Re=ee;let ce;e[30]!==d||e[31]!==p||e[32]!==i?(ce=Ye=>qe=>{const xt=parseFloat(qe.target.value);isNaN(xt)||xt<0||(Ye==="start"&&xt<d&&E(xt),Ye==="end"&&xt>p&&xt<=i&&j(xt))},e[30]=d,e[31]=p,e[32]=i,e[33]=ce):ce=e[33];const Ce=ce;let pe;e[34]!==d||e[35]!==p||e[36]!==u||e[37]!==r.Id||e[38]!==M.valid?(pe=()=>{r.Id&&M.valid&&u({id:r.Id,start:p,end:d})},e[34]=d,e[35]=p,e[36]=u,e[37]=r.Id,e[38]=M.valid,e[39]=pe):pe=e[39];const ye=pe;let we;e[40]!==y||e[41]!==r||e[42]!==o?(we=()=>{y(r),$t({type:"positive",message:o("editor.segmentCopiedToClipboard")})},e[40]=y,e[41]=r,e[42]=o,e[43]=we):we=e[43];const Ee=we;let ue;e[44]!==a||e[45]!==c?(ue=()=>c(a),e[44]=a,e[45]=c,e[46]=ue):ue=e[46];const F=ue;let Ae;e[47]!==p||e[48]!==f?(Ae=()=>f(p),e[47]=p,e[48]=f,e[49]=Ae):Ae=e[49];const De=Ae;let ve;e[50]!==d||e[51]!==f?(ve=()=>f(d),e[50]=d,e[51]=f,e[52]=ve):ve=e[52];const Me=ve;let ie;e[53]!==d||e[54]!==p||e[55]!==u||e[56]!==r.Id||e[57]!==M.valid?(ie=()=>{r.Id&&M.valid&&u({id:r.Id,start:p,end:d})},e[53]=d,e[54]=p,e[55]=u,e[56]=r.Id,e[57]=M.valid,e[58]=ie):ie=e[58];const q=ie;let se;e[59]!==d||e[60]!==p?(se=Ye=>{const qe=Mn(Ye.key,Ye.shiftKey,p,d,Mt);qe.handled&&(Ye.preventDefault(),E(qe.newValue))},e[59]=d,e[60]=p,e[61]=se):se=e[61];const oe=se;let de;e[62]!==d||e[63]!==p||e[64]!==i?(de=Ye=>{const qe=Ln(Ye.key,Ye.shiftKey,p,d,i,Mt);qe.handled&&(Ye.preventDefault(),j(qe.newValue))},e[62]=d,e[63]=p,e[64]=i,e[65]=de):de=e[65];const xe=de;let fe;e[66]!==L||e[67]!==S?(fe=S?{borderColor:L?S.primary:S.primary+"30",boxShadow:L?`0 8px 32px ${S.primary}15`:void 0}:void 0,e[66]=L,e[67]=S,e[68]=fe):fe=e[68];const $=fe;let J;e[69]!==S?(J=S?{color:S.primary}:void 0,e[69]=S,e[70]=J):J=e[70];const V=J,Se=`${z}%`,ze=`${ke}%`;let Ne;e[71]!==U||e[72]!==Se||e[73]!==ze?(Ne={left:Se,width:ze,backgroundColor:U,opacity:.7},e[71]=U,e[72]=Se,e[73]=ze,e[74]=Ne):Ne=e[74];const Be=Ne,Le=`calc(${z}% - ${Us/2}px)`;let We;e[75]!==U||e[76]!==Le?(We={left:Le,backgroundColor:U},e[75]=U,e[76]=Le,e[77]=We):We=e[77];const Fe=We,Ke=`calc(${Z}% - ${Us/2}px)`;let Ie;e[78]!==U||e[79]!==Ke?(Ie={left:Ke,backgroundColor:U},e[78]=U,e[79]=Ke,e[80]=Ie):Ie=e[80];const he=Ie;let Pe;e[81]!==a||e[82]!==g?(Pe=()=>g(a),e[81]=a,e[82]=g,e[83]=Pe):Pe=e[83];const _e=Pe,Ve=L?"border-primary/60 bg-primary/5 shadow-lg shadow-primary/10":"border-border/50 hover:border-primary/30 hover:bg-card/80";let $e;e[84]!==Ve?($e=Q("group relative rounded-xl border bg-card/50 backdrop-blur-sm p-4 transition-all duration-200",Ve),e[84]=Ve,e[85]=$e):$e=e[85];const P="flex items-center justify-between mb-4",H="flex items-center gap-3";let te;e[86]===Symbol.for("react.memo_cache_sentinel")?(te=n.jsx(pn,{className:"size-4 text-muted-foreground/50 cursor-grab opacity-0 group-hover:opacity-100 transition-opacity","aria-hidden":"true"}),e[86]=te):te=e[86];const O=hr,Ge="outline",Je=Q("text-white border-0 font-medium px-3 py-1 shadow-sm",A);let Ue;e[87]!==O||e[88]!==r.Type||e[89]!==Je?(Ue=n.jsx(O,{variant:Ge,className:Je,children:r.Type}),e[87]=O,e[88]=r.Type,e[89]=Je,e[90]=Ue):Ue=e[90];let lt;e[91]!==le?(lt=Qe(le),e[91]=le,e[92]=lt):lt=e[92];let it;e[93]!==lt?(it=n.jsx("span",{className:"text-sm text-muted-foreground font-medium tabular-nums",children:lt}),e[93]=lt,e[94]=it):it=e[94];let Nt;e[95]!==te||e[96]!==Ue||e[97]!==it?(Nt=n.jsxs("div",{className:H,children:[te,Ue,it]}),e[95]=te,e[96]=Ue,e[97]=it,e[98]=Nt):Nt=e[98];let ot;e[99]!==o?(ot=o("accessibility.copySegment"),e[99]=o,e[100]=ot):ot=e[100];let Xe;e[101]!==o?(Xe=o("editor.segmentCopiedToClipboard"),e[101]=o,e[102]=Xe):Xe=e[102];let ct;e[103]!==V?(ct=n.jsx(yr,{className:"size-4","aria-hidden":"true",style:V}),e[103]=V,e[104]=ct):ct=e[104];let Ze;e[105]!==Ee||e[106]!==ot||e[107]!==Xe||e[108]!==ct?(Ze=n.jsx(Oe,{variant:"ghost",size:"icon-sm",onClick:Ee,"aria-label":ot,title:Xe,className:"hover:bg-primary/10",children:ct}),e[105]=Ee,e[106]=ot,e[107]=Xe,e[108]=ct,e[109]=Ze):Ze=e[109];let ut;e[110]!==o?(ut=o("accessibility.deleteSegment"),e[110]=o,e[111]=ut):ut=e[111];let It;e[112]===Symbol.for("react.memo_cache_sentinel")?(It=n.jsx(xr,{className:"size-4","aria-hidden":"true"}),e[112]=It):It=e[112];let dt;e[113]!==F||e[114]!==ut?(dt=n.jsx(Oe,{variant:"ghost",size:"icon-sm",onClick:F,"aria-label":ut,className:"text-destructive/70 hover:text-destructive hover:bg-destructive/10",children:It}),e[113]=F,e[114]=ut,e[115]=dt):dt=e[115];let ft;e[116]!==Ze||e[117]!==dt?(ft=n.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[Ze,dt]}),e[116]=Ze,e[117]=dt,e[118]=ft):ft=e[118];let Pt;e[119]!==Nt||e[120]!==ft?(Pt=n.jsxs("div",{className:P,children:[Nt,ft]}),e[119]=Nt,e[120]=ft,e[121]=Pt):Pt=e[121];let wt;e[122]===Symbol.for("react.memo_cache_sentinel")?(wt={padding:`0 ${Us/2}px`},e[122]=wt):wt=e[122];let mt;e[123]!==r.Type||e[124]!==o?(mt=o("segment.sliderGroup",{type:r.Type}),e[123]=r.Type,e[124]=o,e[125]=mt):mt=e[125];const Rt=`segment-${r.Id}-description`,hs=`segment-${r.Id}-description`;let gt;e[126]!==le||e[127]!==d||e[128]!==p||e[129]!==r.Type||e[130]!==o?(gt=o("segment.sliderDescription",{type:r.Type,start:Qe(p),end:Qe(d),duration:Qe(le)}),e[126]=le,e[127]=d,e[128]=p,e[129]=r.Type,e[130]=o,e[131]=gt):gt=e[131];let bt;e[132]!==hs||e[133]!==gt?(bt=n.jsx("span",{id:hs,className:"sr-only",children:gt}),e[132]=hs,e[133]=gt,e[134]=bt):bt=e[134];let pt;e[135]!==Be?(pt=n.jsx("div",{className:"absolute top-1 bottom-1 rounded-md transition-all duration-75",style:Be}),e[135]=Be,e[136]=pt):pt=e[136];let At;e[137]===Symbol.for("react.memo_cache_sentinel")?(At=Q("segment-handle absolute top-0 bottom-0 w-3.5 cursor-ew-resize z-10","focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","flex items-center justify-center"),e[137]=At):At=e[137];let Dt;e[138]!==r.Type||e[139]!==o?(Dt=o("segment.startHandle",{type:r.Type}),e[138]=r.Type,e[139]=o,e[140]=Dt):Dt=e[140];const vt=d-Mt;let et;e[141]!==p?(et=Qe(p),e[141]=p,e[142]=et):et=e[142];let tt;e[143]!==be?(tt=be("start"),e[143]=be,e[144]=tt):tt=e[144];let ht;e[145]===Symbol.for("react.memo_cache_sentinel")?(ht=n.jsx("div",{className:"w-0.5 h-4 bg-white/60 rounded-full"}),e[145]=ht):ht=e[145];let st;e[146]!==q||e[147]!==oe||e[148]!==p||e[149]!==Fe||e[150]!==Dt||e[151]!==vt||e[152]!==et||e[153]!==tt?(st=n.jsx("div",{className:At,style:Fe,role:"slider","aria-label":Dt,"aria-valuemin":0,"aria-valuemax":vt,"aria-valuenow":p,"aria-valuetext":et,"aria-orientation":"horizontal",tabIndex:0,onPointerDown:tt,onKeyDown:oe,onBlur:q,children:ht}),e[146]=q,e[147]=oe,e[148]=p,e[149]=Fe,e[150]=Dt,e[151]=vt,e[152]=et,e[153]=tt,e[154]=st):st=e[154];let yt;e[155]===Symbol.for("react.memo_cache_sentinel")?(yt=Q("segment-handle absolute top-0 bottom-0 w-3.5 cursor-ew-resize z-10","focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","flex items-center justify-center"),e[155]=yt):yt=e[155];let rt;e[156]!==r.Type||e[157]!==o?(rt=o("segment.endHandle",{type:r.Type}),e[156]=r.Type,e[157]=o,e[158]=rt):rt=e[158];const St=p+Mt;let Tt;e[159]!==d?(Tt=Qe(d),e[159]=d,e[160]=Tt):Tt=e[160];let nt;e[161]!==be?(nt=be("end"),e[161]=be,e[162]=nt):nt=e[162];let Et;e[163]===Symbol.for("react.memo_cache_sentinel")?(Et=n.jsx("div",{className:"w-0.5 h-4 bg-white/60 rounded-full"}),e[163]=Et):Et=e[163];let v;e[164]!==he||e[165]!==xe||e[166]!==q||e[167]!==d||e[168]!==i||e[169]!==rt||e[170]!==St||e[171]!==Tt||e[172]!==nt?(v=n.jsx("div",{className:yt,style:he,role:"slider","aria-label":rt,"aria-valuemin":St,"aria-valuemax":i,"aria-valuenow":d,"aria-valuetext":Tt,"aria-orientation":"horizontal",tabIndex:0,onPointerDown:nt,onKeyDown:xe,onBlur:q,children:Et}),e[164]=he,e[165]=xe,e[166]=q,e[167]=d,e[168]=i,e[169]=rt,e[170]=St,e[171]=Tt,e[172]=nt,e[173]=v):v=e[173];let me;e[174]!==pt||e[175]!==st||e[176]!==v?(me=n.jsxs("div",{className:"relative h-full w-full",children:[pt,st,v]}),e[174]=pt,e[175]=st,e[176]=v,e[177]=me):me=e[177];let at;e[178]!==je||e[179]!==Re||e[180]!==mt||e[181]!==Rt||e[182]!==bt||e[183]!==me?(at=n.jsxs("div",{ref:h,className:"relative h-10 bg-muted/50 rounded-lg cursor-pointer mb-4 touch-none overflow-hidden",style:wt,role:"group","aria-label":mt,"aria-describedby":Rt,onPointerMove:je,onPointerUp:Re,onPointerLeave:Re,children:[bt,me]}),e[178]=je,e[179]=Re,e[180]=mt,e[181]=Rt,e[182]=bt,e[183]=me,e[184]=at):at=e[184];let _t;e[185]!==o?(_t=o("accessibility.seekToStart"),e[185]=o,e[186]=_t):_t=e[186];let Ut;e[187]!==o?(Ut=o("accessibility.seekToStart"),e[187]=o,e[188]=Ut):Ut=e[188];let Ot;e[189]!==V?(Ot=n.jsx(Hs,{className:"size-3","aria-hidden":"true",style:V}),e[189]=V,e[190]=Ot):Ot=e[190];let Vt;e[191]!==De||e[192]!==_t||e[193]!==Ut||e[194]!==Ot?(Vt=n.jsx(Oe,{variant:"ghost",size:"icon-sm",onClick:De,"aria-label":_t,title:Ut,className:"shrink-0 hover:bg-primary/10",children:Ot}),e[191]=De,e[192]=_t,e[193]=Ut,e[194]=Ot,e[195]=Vt):Vt=e[195];const Es=`segment-${r.Id}-start`;let Ht;e[196]!==o?(Ht=o("segment.start"),e[196]=o,e[197]=Ht):Ht=e[197];let Bt;e[198]!==Es||e[199]!==Ht?(Bt=n.jsxs("label",{htmlFor:Es,className:"text-sm text-muted-foreground whitespace-nowrap shrink-0",children:[Ht,":"]}),e[198]=Es,e[199]=Ht,e[200]=Bt):Bt=e[200];const _s=`segment-${r.Id}-start`,js=d-.001;let Kt;e[201]!==p?(Kt=p.toFixed(3),e[201]=p,e[202]=Kt):Kt=e[202];let Gt;e[203]!==Ce?(Gt=Ce("start"),e[203]=Ce,e[204]=Gt):Gt=e[204];const Cs=`segment-${r.Id}-start-formatted`;let Wt;e[205]!==ye||e[206]!==_s||e[207]!==js||e[208]!==Kt||e[209]!==Gt||e[210]!==Cs?(Wt=n.jsx(ws,{id:_s,type:"number",step:"0.001",min:"0",max:js,value:Kt,onChange:Gt,onBlur:ye,className:"w-full sm:w-28 h-8 text-sm font-mono bg-background/50","aria-describedby":Cs}),e[205]=ye,e[206]=_s,e[207]=js,e[208]=Kt,e[209]=Gt,e[210]=Cs,e[211]=Wt):Wt=e[211];const Ns=`segment-${r.Id}-start-formatted`;let Yt;e[212]!==p?(Yt=Qe(p),e[212]=p,e[213]=Yt):Yt=e[213];let qt;e[214]!==Ns||e[215]!==Yt?(qt=n.jsx("span",{id:Ns,className:"text-xs text-muted-foreground shrink-0 hidden sm:inline tabular-nums",children:Yt}),e[214]=Ns,e[215]=Yt,e[216]=qt):qt=e[216];let Jt;e[217]!==Vt||e[218]!==Bt||e[219]!==Wt||e[220]!==qt?(Jt=n.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[Vt,Bt,Wt,qt]}),e[217]=Vt,e[218]=Bt,e[219]=Wt,e[220]=qt,e[221]=Jt):Jt=e[221];let Qt;e[222]!==o?(Qt=o("accessibility.seekToEnd"),e[222]=o,e[223]=Qt):Qt=e[223];let Xt;e[224]!==o?(Xt=o("accessibility.seekToEnd"),e[224]=o,e[225]=Xt):Xt=e[225];let Zt;e[226]!==V?(Zt=n.jsx(Hs,{className:"size-3","aria-hidden":"true",style:V}),e[226]=V,e[227]=Zt):Zt=e[227];let es;e[228]!==Me||e[229]!==Qt||e[230]!==Xt||e[231]!==Zt?(es=n.jsx(Oe,{variant:"ghost",size:"icon-sm",onClick:Me,"aria-label":Qt,title:Xt,className:"shrink-0 hover:bg-primary/10",children:Zt}),e[228]=Me,e[229]=Qt,e[230]=Xt,e[231]=Zt,e[232]=es):es=e[232];const Is=`segment-${r.Id}-end`;let ts;e[233]!==o?(ts=o("segment.end"),e[233]=o,e[234]=ts):ts=e[234];let ss;e[235]!==Is||e[236]!==ts?(ss=n.jsxs("label",{htmlFor:Is,className:"text-sm text-muted-foreground whitespace-nowrap shrink-0",children:[ts,":"]}),e[235]=Is,e[236]=ts,e[237]=ss):ss=e[237];const Ps=`segment-${r.Id}-end`,Rs=p+.001;let rs;e[238]!==d?(rs=d.toFixed(3),e[238]=d,e[239]=rs):rs=e[239];let ns;e[240]!==Ce?(ns=Ce("end"),e[240]=Ce,e[241]=ns):ns=e[241];const As=`segment-${r.Id}-end-formatted`;let as;e[242]!==ye||e[243]!==i||e[244]!==Ps||e[245]!==Rs||e[246]!==rs||e[247]!==ns||e[248]!==As?(as=n.jsx(ws,{id:Ps,type:"number",step:"0.001",min:Rs,max:i,value:rs,onChange:ns,onBlur:ye,className:"w-full sm:w-28 h-8 text-sm font-mono bg-background/50","aria-describedby":As}),e[242]=ye,e[243]=i,e[244]=Ps,e[245]=Rs,e[246]=rs,e[247]=ns,e[248]=As,e[249]=as):as=e[249];const Ds=`segment-${r.Id}-end-formatted`;let ls;e[250]!==d?(ls=Qe(d),e[250]=d,e[251]=ls):ls=e[251];let is;e[252]!==Ds||e[253]!==ls?(is=n.jsx("span",{id:Ds,className:"text-xs text-muted-foreground shrink-0 hidden sm:inline tabular-nums",children:ls}),e[252]=Ds,e[253]=ls,e[254]=is):is=e[254];let os;e[255]!==as||e[256]!==is||e[257]!==es||e[258]!==ss?(os=n.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[es,ss,as,is]}),e[255]=as,e[256]=is,e[257]=es,e[258]=ss,e[259]=os):os=e[259];let cs;e[260]!==os||e[261]!==Jt?(cs=n.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-6",children:[Jt,os]}),e[260]=os,e[261]=Jt,e[262]=cs):cs=e[262];let us;e[263]!==o||e[264]!==M.error||e[265]!==M.valid?(us=!M.valid&&n.jsxs("p",{className:"text-sm text-destructive mt-3 flex items-center gap-2",role:"alert",children:[n.jsx("span",{className:"size-1.5 rounded-full bg-destructive"}),M.error??o("validation.StartEnd")]}),e[263]=o,e[264]=M.error,e[265]=M.valid,e[266]=us):us=e[266];let xs;return e[267]!==$||e[268]!==_e||e[269]!==cs||e[270]!==us||e[271]!==$e||e[272]!==Pt||e[273]!==at?(xs=n.jsxs("div",{className:$e,style:$,onClick:_e,children:[Pt,at,cs,us]}),e[267]=$,e[268]=_e,e[269]=cs,e[270]=us,e[271]=$e,e[272]=Pt,e[273]=at,e[274]=xs):xs=e[274],xs});function tl(s){const t=He.c(4);let e;t[0]!==s?({...e}=s,t[0]=s,t[1]=e):e=t[1];let r;return t[2]!==e?(r=n.jsx(hn,{"data-slot":"alert-dialog",...e}),t[2]=e,t[3]=r):r=t[3],r}function sl(s){const t=He.c(4);let e;t[0]!==s?({...e}=s,t[0]=s,t[1]=e):e=t[1];let r;return t[2]!==e?(r=n.jsx(Sn,{"data-slot":"alert-dialog-portal",...e}),t[2]=e,t[3]=r):r=t[3],r}function rl(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 bg-black/80 duration-100 supports-backdrop-filter:backdrop-blur-xs fixed inset-0 isolate z-50",e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx(Tn,{"data-slot":"alert-dialog-overlay",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function nl(s){const t=He.c(11);let e,r,a;t[0]!==s?({className:e,size:a,...r}=s,t[0]=s,t[1]=e,t[2]=r,t[3]=a):(e=t[1],r=t[2],a=t[3]);const l=a===void 0?"default":a;let i;t[4]===Symbol.for("react.memo_cache_sentinel")?(i=n.jsx(rl,{}),t[4]=i):i=t[4];let u;t[5]!==e?(u=Q("data-open:animate-in data-closed:animate-out data-closed:fade-out-0 data-open:fade-in-0 data-closed:zoom-out-95 data-open:zoom-in-95 bg-background ring-foreground/5 gap-6 rounded-4xl p-6 ring-1 duration-100 data-[size=default]:max-w-xs data-[size=sm]:max-w-xs data-[size=default]:sm:max-w-md group/alert-dialog-content fixed top-1/2 left-1/2 z-50 grid w-full -translate-x-1/2 -translate-y-1/2 outline-none",e),t[5]=e,t[6]=u):u=t[6];let c;return t[7]!==r||t[8]!==l||t[9]!==u?(c=n.jsxs(sl,{children:[i,n.jsx(yn,{"data-slot":"alert-dialog-content","data-size":l,className:u,...r})]}),t[7]=r,t[8]=l,t[9]=u,t[10]=c):c=t[10],c}function al(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q("grid grid-rows-[auto_1fr] place-items-center gap-1.5 text-center has-data-[slot=alert-dialog-media]:grid-rows-[auto_auto_1fr] has-data-[slot=alert-dialog-media]:gap-x-6 sm:group-data-[size=default]/alert-dialog-content:place-items-start sm:group-data-[size=default]/alert-dialog-content:text-left sm:group-data-[size=default]/alert-dialog-content:has-data-[slot=alert-dialog-media]:grid-rows-[auto_1fr]",e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx("div",{"data-slot":"alert-dialog-header",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function ll(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q("flex flex-col-reverse gap-2 group-data-[size=sm]/alert-dialog-content:grid group-data-[size=sm]/alert-dialog-content:grid-cols-2 sm:flex-row sm:justify-end",e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx("div",{"data-slot":"alert-dialog-footer",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function il(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q("text-lg font-medium sm:group-data-[size=default]/alert-dialog-content:group-has-data-[slot=alert-dialog-media]/alert-dialog-content:col-start-2",e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx(xn,{"data-slot":"alert-dialog-title",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function ol(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q("text-muted-foreground *:[a]:hover:text-foreground text-sm text-balance md:text-pretty *:[a]:underline *:[a]:underline-offset-3",e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx(bn,{"data-slot":"alert-dialog-description",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function cl(s){const t=He.c(8);let e,r;t[0]!==s?({className:e,...r}=s,t[0]=s,t[1]=e,t[2]=r):(e=t[1],r=t[2]);let a;t[3]!==e?(a=Q(e),t[3]=e,t[4]=a):a=t[4];let l;return t[5]!==r||t[6]!==a?(l=n.jsx(Oe,{"data-slot":"alert-dialog-action",className:a,...r}),t[5]=r,t[6]=a,t[7]=l):l=t[7],l}function ul(s){const t=He.c(14);let e,r,a,l;t[0]!==s?({className:e,variant:a,size:l,...r}=s,t[0]=s,t[1]=e,t[2]=r,t[3]=a,t[4]=l):(e=t[1],r=t[2],a=t[3],l=t[4]);const i=a===void 0?"outline":a,u=l===void 0?"default":l;let c;t[5]!==e?(c=Q(e),t[5]=e,t[6]=c):c=t[6];let f;t[7]!==u||t[8]!==i?(f=n.jsx(Oe,{variant:i,size:u}),t[7]=u,t[8]=i,t[9]=f):f=t[9];let g;return t[10]!==r||t[11]!==c||t[12]!==f?(g=n.jsx(vn,{"data-slot":"alert-dialog-cancel",className:c,render:f,...r}),t[10]=r,t[11]=c,t[12]=f,t[13]=g):g=t[13],g}const dl=s=>s.saveToClipboard;function fl({open:s,segment:t,onClose:e,onSave:r,onDelete:a}){const{t:l}=ps(),i=Lt(dl),u=m.useRef(null),c=m.useRef(null),[f,g]=m.useState(t),[o,y]=m.useState(!1),[S,h]=m.useState(""),[w,T]=m.useState("");m.useEffect(()=>{g(t),h(String(t.StartTicks??0)),T(String(t.EndTicks??0))},[t]),m.useEffect(()=>{s&&(c.current=document.activeElement)},[s]),m.useEffect(()=>{if(!s)return;const N=window.setTimeout(()=>u.current?.focus(),0);return()=>window.clearTimeout(N)},[s]);const p=m.useCallback(()=>{e(),requestAnimationFrame(()=>{c.current?.focus()})},[e]),{startSeconds:E,endSeconds:d,duration:j,validation:x}=m.useMemo(()=>{const N=f.StartTicks??0,_=f.EndTicks??0;return{startSeconds:N,endSeconds:_,duration:_-N,validation:Ks(f)}},[f]),I=m.useCallback((N,_)=>{const C=Ur(_);C<0||g(L=>({...L,[N==="start"?"StartTicks":"EndTicks"]:C}))},[]),R=m.useCallback(()=>{I("start",S),I("end",w),x.valid&&(r(f),p())},[I,S,w,x.valid,f,r,p]),D=m.useCallback(()=>{i(f),$t({type:"positive",message:l("editor.segmentCopiedToClipboard")})},[f,i,l]),k=m.useCallback(()=>{a(f),y(!1),p()},[f,a,p]),B=Vs(f.Type);return n.jsxs(n.Fragment,{children:[n.jsx(Or,{open:s,onOpenChange:N=>!N&&p(),children:n.jsxs(Vr,{className:"sm:max-w-md",children:[n.jsxs(Hr,{children:[n.jsxs(Br,{className:"flex items-center gap-2",children:[l("segment.edit"),n.jsx(hr,{variant:"outline",className:Q("text-white border-0 ml-2",B),children:f.Type})]}),n.jsx(Kr,{children:l("editor.slider.title")})]}),n.jsxs("div",{className:"grid gap-4 py-4","aria-describedby":x.valid?void 0:"segment-validation-error",children:[n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx(bs,{htmlFor:"segment-type",className:"sm:text-right",children:l("segment.type")}),n.jsx("div",{className:"sm:col-span-3",children:n.jsxs(Gr,{value:f.Type??"Unknown",onValueChange:N=>N&&g(_=>({..._,Type:N})),children:[n.jsx(Wr,{id:"segment-type",children:n.jsx(Yr,{})}),n.jsx(qr,{children:gr.map(N=>n.jsx(Jr,{value:N,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:Q("size-3 rounded-full",Vs(N))}),N]})},N))})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx(bs,{htmlFor:"segment-start",className:"sm:text-right",children:l("segment.start")}),n.jsxs("div",{className:"sm:col-span-3 flex items-center gap-2",children:[n.jsx(ws,{id:"segment-start",ref:u,type:"text",inputMode:"decimal",value:S,onChange:N=>h(N.target.value),onBlur:()=>I("start",S),className:"font-mono flex-1"}),n.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:Qe(E)})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx(bs,{htmlFor:"segment-end",className:"sm:text-right",children:l("segment.end")}),n.jsxs("div",{className:"sm:col-span-3 flex items-center gap-2",children:[n.jsx(ws,{id:"segment-end",type:"text",inputMode:"decimal",value:w,onChange:N=>T(N.target.value),onBlur:()=>I("end",w),className:"font-mono flex-1"}),n.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:Qe(d)})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 items-start sm:items-center gap-2 sm:gap-4",children:[n.jsx(bs,{className:"sm:text-right",children:l("segment.duration")}),n.jsxs("div",{className:"sm:col-span-3",children:[n.jsx("span",{className:"text-sm font-mono",children:Qe(j)}),n.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",j.toFixed(3),"s)"]})]})]}),!x.valid&&n.jsx("p",{id:"segment-validation-error",role:"alert",className:"text-sm text-destructive text-center col-span-full",children:x.error??l("validation.StartEnd")})]}),n.jsxs(Qr,{className:"flex-col gap-3 sm:flex-row sm:gap-2",children:[n.jsxs("div",{className:"flex gap-2 w-full sm:w-auto sm:flex-1 order-2 sm:order-1",children:[n.jsxs(Oe,{variant:"outline",size:"sm",onClick:D,className:"flex-1 sm:flex-none",children:[n.jsx(yr,{className:"size-4 mr-2"}),"Copy"]}),n.jsxs(Oe,{variant:"destructive",size:"sm",onClick:()=>y(!0),className:"flex-1 sm:flex-none",children:[n.jsx(xr,{className:"size-4 mr-2"}),"Delete"]})]}),n.jsxs("div",{className:"flex gap-2 w-full sm:w-auto order-1 sm:order-2",children:[n.jsx(Oe,{variant:"outline",onClick:p,className:"flex-1 sm:flex-none",children:l("close")}),n.jsxs(Oe,{onClick:R,disabled:!x.valid,className:"flex-1 sm:flex-none",children:[n.jsx(br,{className:"size-4 mr-2"}),l("editor.saveSegment")]})]})]})]})}),n.jsx(tl,{open:o,onOpenChange:y,children:n.jsxs(nl,{children:[n.jsxs(al,{children:[n.jsx(il,{children:l("editor.deleteSureTitle")}),n.jsx(ol,{children:l("editor.deleteSure",{Type:f.Type})})]}),n.jsxs(ll,{children:[n.jsx(ul,{onClick:()=>y(!1),children:l("no")}),n.jsx(cl,{onClick:k,children:l("yes")})]})]})})]})}const ml=s=>s.clipboardSegment,gl=s=>s.vibrantColors;function pl(s){const t=He.c(111),{item:e,fetchSegments:r,className:a}=s,l=r===void 0?!0:r,{t:i}=ps(),u=gs(yl),c=Lt(ml),f=Lt(gl),{getButtonStyle:g,iconColor:o,hasColors:y}=Sr(f),S=qa(),h=l&&!!e.Id;let w;t[0]!==h?(w={enabled:h},t[0]=h,t[1]=w):w=t[1];const{data:T,isLoading:p}=Xr(e.Id??"",w);let E;t[2]!==T?(E=T===void 0?[]:T,t[2]=T,t[3]=E):E=t[3];const d=E;let j;t[4]===Symbol.for("react.memo_cache_sentinel")?(j=[],t[4]=j):j=t[4];const[x,I]=m.useState(j),[R,D]=m.useState(0),[k,B]=m.useState(),[N,_]=m.useState(!1),[C,L]=m.useState(null),A=S.isPending,W=m.useRef(null),U=m.useRef(x);let re,Y;t[5]!==x?(re=()=>{U.current=x},Y=[x],t[5]=x,t[6]=re,t[7]=Y):(re=t[6],Y=t[7]),m.useEffect(re,Y);const K=m.useRef(null);let M,ne;t[8]===Symbol.for("react.memo_cache_sentinel")?(ne=()=>()=>{K.current&&clearTimeout(K.current),W.current?.abort()},M=[],t[8]=M,t[9]=ne):(M=t[8],ne=t[9]),m.useEffect(ne,M);let X;t[10]!==e.RunTimeTicks?(X=Zr(e.RunTimeTicks)||0,t[10]=e.RunTimeTicks,t[11]=X):X=t[11];const ae=X;let G,Te;t[12]!==d?(G=()=>{d.length>0&&I([...d].sort(fs))},Te=[d],t[12]=d,t[13]=G,t[14]=Te):(G=t[13],Te=t[14]),m.useEffect(G,Te);let z;t[15]!==e.Id?(z=P=>{const H={Id:Xs(),ItemId:e.Id,Type:P.type,StartTicks:P.start,EndTicks:P.end??P.start+1};I(te=>{const O=[...te,H].sort(fs),Ge=O.findIndex(Je=>Je.Id===H.Id);return D(Ge>=0?Ge:O.length-1),O})},t[15]=e.Id,t[16]=z):z=t[16];const Z=z;let ke;t[17]!==R?(ke=P=>{I(H=>{if(H.length===0)return H;const te=[...H],O=te[R];return O===void 0?H:(P.start?O.StartTicks=P.currentTime:O.EndTicks=P.currentTime,te.sort(fs))})},t[17]=R,t[18]=ke):ke=t[18];const le=ke;let ge;t[19]===Symbol.for("react.memo_cache_sentinel")?(ge=P=>{I(H=>H.map(O=>O.Id===P.id?{...O,StartTicks:P.start,EndTicks:P.end}:O).sort(fs))},t[19]=ge):ge=t[19];const be=ge;let b;t[20]===Symbol.for("react.memo_cache_sentinel")?(b=P=>{I(H=>{const te=[...H];return te.splice(P,1),D(O=>Math.max(0,Math.min(O,te.length-1))),te})},t[20]=b):b=t[20];const je=b;let ee;t[21]===Symbol.for("react.memo_cache_sentinel")?(ee=P=>{K.current&&clearTimeout(K.current),B(P),K.current=setTimeout(()=>B(void 0),100)},t[21]=ee):ee=t[21];const Re=ee;let ce;t[22]===Symbol.for("react.memo_cache_sentinel")?(ce=P=>{L(P),_(!0)},t[22]=ce):ce=t[22];const Ce=ce;let pe;t[23]===Symbol.for("react.memo_cache_sentinel")?(pe=()=>{_(!1),L(null)},t[23]=pe):pe=t[23];const ye=pe;let we;t[24]===Symbol.for("react.memo_cache_sentinel")?(we=P=>{I(H=>H.map(O=>O.Id===P.Id?P:O).sort(fs))},t[24]=we):we=t[24];const Ee=we;let ue;t[25]===Symbol.for("react.memo_cache_sentinel")?(ue=P=>{I(H=>H.filter(te=>te.Id!==P.Id)),D(hl)},t[25]=ue):ue=t[25];const F=ue;let Ae;t[26]!==c||t[27]!==e.Id||t[28]!==ae||t[29]!==i?(Ae=()=>{if(!c){$t({type:"negative",message:i("editor.noSegmentInClipboard")});return}const P=Ks(c,ae);if(!P.valid){$t({type:"negative",message:P.error??"Invalid segment data"});return}const H={...c,Id:Xs(),ItemId:e.Id};I(te=>{const O=[...te,H].sort(fs),Ge=O.findIndex(Je=>Je.Id===H.Id);return D(Ge>=0?Ge:O.length-1),O}),$t({type:"positive",message:"Segment pasted from clipboard"})},t[26]=c,t[27]=e.Id,t[28]=ae,t[29]=i,t[30]=Ae):Ae=t[30];const De=Ae;let ve;t[31]!==S||t[32]!==A||t[33]!==e.Id||t[34]!==d||t[35]!==i?(ve=async()=>{if(!e.Id||A)return;W.current?.abort();const P=new AbortController;W.current=P;const H=U.current;try{await S.mutateAsync({itemId:e.Id,existingSegments:d,newSegments:H}),P.signal.aborted||$t({type:"positive",message:i("editor.saveSegment")})}catch{}},t[31]=S,t[32]=A,t[33]=e.Id,t[34]=d,t[35]=i,t[36]=ve):ve=t[36];const Me=ve;let ie;t[37]!==a?(ie=Q("flex flex-col gap-6 max-w-6xl mx-auto",a),t[37]=a,t[38]=ie):ie=t[38];let q;t[39]!==Z||t[40]!==le||t[41]!==e||t[42]!==k||t[43]!==u?(q=u&&n.jsx(za,{item:e,timestamp:k,onCreateSegment:Z,onUpdateSegmentTimestamp:le}),t[39]=Z,t[40]=le,t[41]=e,t[42]=k,t[43]=u,t[44]=q):q=t[44];let se;t[45]!==Z||t[46]!==u||t[47]!==i?(se=!u&&n.jsx("div",{className:"flex justify-center",children:n.jsx(Oe,{variant:"outline",onClick:()=>Z({type:"Intro",start:0}),children:i("editor.newSegment")})}),t[45]=Z,t[46]=u,t[47]=i,t[48]=se):se=t[48];let oe;t[49]!==R||t[50]!==x||t[51]!==p||t[52]!==ae||t[53]!==i?(oe=n.jsx("div",{className:"space-y-4",children:p?n.jsx(In,{count:2}):x.length===0?n.jsx("p",{className:"text-center text-muted-foreground py-8",children:i("editor.noSegments")}):n.jsx("div",{className:"space-y-3",children:x.map((P,H)=>n.jsx("div",{onDoubleClick:()=>Ce(H),children:n.jsx(el,{segment:P,index:H,activeIndex:R,runtimeSeconds:ae,onUpdate:be,onDelete:je,onPlayerTimestamp:Re,onSetActive:D})},P.Id))})}),t[49]=R,t[50]=x,t[51]=p,t[52]=ae,t[53]=i,t[54]=oe):oe=t[54];let de;t[55]!==N||t[56]!==C||t[57]!==x?(de=C!==null&&x[C]&&n.jsx(fl,{open:N,segment:x[C],onClose:ye,onSave:Ee,onDelete:F}),t[55]=N,t[56]=C,t[57]=x,t[58]=de):de=t[58];let xe;t[59]!==i?(xe=i("editor.actions","Segment actions"),t[59]=i,t[60]=xe):xe=t[60];let fe;t[61]!==i?(fe=i("editor.paste","Paste segment from clipboard"),t[61]=i,t[62]=fe):fe=t[62];const $=!y&&"bg-secondary/60 text-muted-foreground hover:bg-secondary hover:text-foreground border-transparent";let J;t[63]!==$?(J=Q("flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-full text-base font-semibold","sm:flex-none sm:px-10 sm:py-4 sm:text-lg sm:min-w-[var(--spacing-button-min)]","transition-all duration-200 ease-out border-2","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",$),t[63]=$,t[64]=J):J=t[64];let V;t[65]!==g?(V=g(!1),t[65]=g,t[66]=V):V=t[66];let Se;t[67]!==o?(Se=o?{color:o}:void 0,t[67]=o,t[68]=Se):Se=t[68];let ze;t[69]!==Se?(ze=n.jsx(kn,{className:"size-4 sm:size-5","aria-hidden":"true",style:Se}),t[69]=Se,t[70]=ze):ze=t[70];let Ne;t[71]!==i?(Ne=i("editor.paste","Paste"),t[71]=i,t[72]=Ne):Ne=t[72];let Be;t[73]!==De||t[74]!==fe||t[75]!==J||t[76]!==V||t[77]!==ze||t[78]!==Ne?(Be=n.jsxs("button",{onClick:De,"aria-label":fe,className:J,style:V,children:[ze,Ne]}),t[73]=De,t[74]=fe,t[75]=J,t[76]=V,t[77]=ze,t[78]=Ne,t[79]=Be):Be=t[79];let Le;t[80]!==i?(Le=i("editor.saveSegment","Save all segments"),t[80]=i,t[81]=Le):Le=t[81];const We=!y&&"bg-primary/20 text-primary border-primary/40 hover:bg-primary/30";let Fe;t[82]!==We?(Fe=Q("flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-full text-base font-semibold","sm:flex-none sm:px-10 sm:py-4 sm:text-lg sm:min-w-[var(--spacing-button-min)]","transition-all duration-200 ease-out border-2","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed",We),t[82]=We,t[83]=Fe):Fe=t[83];let Ke;t[84]!==g?(Ke=g(!0),t[84]=g,t[85]=Ke):Ke=t[85];let Ie,he;t[86]!==A?(Ie=A?n.jsx(wn,{className:"size-4 sm:size-5 animate-spin","aria-hidden":"true"}):n.jsx(br,{className:"size-4 sm:size-5","aria-hidden":"true"}),he=A&&n.jsx("span",{className:"sr-only",children:"Saving segments"}),t[86]=A,t[87]=Ie,t[88]=he):(Ie=t[87],he=t[88]);let Pe;t[89]!==i?(Pe=i("editor.saveSegment"),t[89]=i,t[90]=Pe):Pe=t[90];let _e;t[91]!==Me||t[92]!==A||t[93]!==Le||t[94]!==Fe||t[95]!==Ke||t[96]!==Ie||t[97]!==he||t[98]!==Pe?(_e=n.jsxs("button",{onClick:Me,disabled:A,"aria-label":Le,"aria-busy":A,"aria-live":"polite",className:Fe,style:Ke,children:[Ie,he,Pe]}),t[91]=Me,t[92]=A,t[93]=Le,t[94]=Fe,t[95]=Ke,t[96]=Ie,t[97]=he,t[98]=Pe,t[99]=_e):_e=t[99];let Ve;t[100]!==xe||t[101]!==Be||t[102]!==_e?(Ve=n.jsxs("div",{className:"flex flex-row justify-center gap-4",role:"group","aria-label":xe,children:[Be,_e]}),t[100]=xe,t[101]=Be,t[102]=_e,t[103]=Ve):Ve=t[103];let $e;return t[104]!==ie||t[105]!==q||t[106]!==se||t[107]!==oe||t[108]!==de||t[109]!==Ve?($e=n.jsxs("div",{className:ie,children:[q,se,oe,de,Ve]}),t[104]=ie,t[105]=q,t[106]=se,t[107]=oe,t[108]=de,t[109]=Ve,t[110]=$e):$e=t[110],$e}function hl(s){return Math.max(0,s-1)}function yl(s){return s.showVideoPlayer}function xl(){const s=He.c(4);let t;s[0]===Symbol.for("react.memo_cache_sentinel")?(t=n.jsx("span",{className:"sr-only",children:"Loading player"}),s[0]=t):t=s[0];let e;s[1]===Symbol.for("react.memo_cache_sentinel")?(e=n.jsx(Ls,{className:"aspect-video w-full rounded-2xl"}),s[1]=e):e=s[1];let r;s[2]===Symbol.for("react.memo_cache_sentinel")?(r=n.jsx(Ls,{className:"h-20 w-full rounded-2xl animate-in fade-in duration-300",style:{animationDelay:"50ms"}}),s[2]=r):r=s[2];let a;return s[3]===Symbol.for("react.memo_cache_sentinel")?(a=n.jsxs("main",{className:"min-h-[var(--spacing-page-min-height-lg)] px-4 py-6 sm:px-6 overflow-auto",role:"status","aria-live":"polite","aria-busy":"true",children:[t,n.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e,n.jsxs("div",{className:"space-y-4",children:[r,n.jsx(Ls,{className:"h-20 w-full rounded-2xl animate-in fade-in duration-300",style:{animationDelay:"100ms"}})]})]})]}),s[3]=a):a=s[3],a}function Rl(){const s=He.c(17),{itemId:t}=Zs.useParams(),{fetchSegments:e}=Zs.useSearch(),{data:r,isLoading:a,error:l}=en(t);let i;s[0]!==r?(i=r?vr(r,300):null,s[0]=r,s[1]=i):i=s[1];const c=Rn(i||null),f=Lt(bl);let g,o;if(s[2]!==f||s[3]!==c?(g=()=>(f(c),()=>f(null)),o=[c,f],s[2]=f,s[3]=c,s[4]=g,s[5]=o):(g=s[4],o=s[5]),m.useEffect(g,o),a){let w;return s[6]===Symbol.for("react.memo_cache_sentinel")?(w=n.jsx(xl,{}),s[6]=w):w=s[6],w}if(l||!r){const w=l?.message||"Item not found";let T;return s[7]!==w?(T=n.jsx(Pn,{message:w,minHeightClass:"min-h-[var(--spacing-page-min-height-lg)]"}),s[7]=w,s[8]=T):T=s[8],T}let y;s[9]!==c?(y=c&&n.jsx("div",{className:"fixed inset-0 -z-10 transition-colors duration-700",style:{backgroundColor:c.background}}),s[9]=c,s[10]=y):y=s[10];let S;s[11]!==e||s[12]!==r?(S=n.jsx("main",{className:"min-h-[var(--spacing-page-min-height-lg)] px-4 py-6 sm:px-6 overflow-auto",children:n.jsx(Nn,{featureName:"Player",minHeightClass:"min-h-[var(--spacing-page-min-height-lg)]",children:n.jsx(pl,{item:r,fetchSegments:e})})}),s[11]=e,s[12]=r,s[13]=S):S=s[13];let h;return s[14]!==y||s[15]!==S?(h=n.jsxs(n.Fragment,{children:[y,S]}),s[14]=y,s[15]=S,s[16]=h):h=s[16],h}function bl(s){return s.setVibrantColors}export{Rl as component};
